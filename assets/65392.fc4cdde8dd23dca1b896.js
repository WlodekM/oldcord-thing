"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["65392"],{935369:function(t,e,n){n.d(e,{Z:function(){return l}}),n(47120);var r=n(470079),u=n(479531),i=n(689938);function l(t){let[e,n]=r.useState(!1),[l,c]=r.useState(null);return[r.useCallback(async function(){for(var e=arguments.length,r=Array(e),l=0;l<e;l++)r[l]=arguments[l];try{return c(null),n(!0),await t(...r)}catch(t){t.message!==i.Z.Messages.MFA_V2_CANCELED&&c(t instanceof u.Z?t:new u.Z(t))}finally{n(!1)}},[t]),{loading:e,error:l}]}},724757:function(t,e,n){n.d(e,{Z:function(){return c}});var r=n(470079),u=n(924826),i=n(442837),l=n(607070);function c(t,e,n){let c=(0,i.e7)([l.Z],()=>l.Z.keyboardModeEnabled),a=r.useCallback(t=>{let n=document.querySelector(t),r=e.current;null!=n&&null!=r&&(n.focus(),r.scrollIntoViewNode({node:n,padding:80}))},[e]),o=r.useCallback(()=>new Promise(t=>{let n=e.current;if(null==n)return t();n.scrollTo({to:0,callback:()=>requestAnimationFrame(()=>t())})}),[e]),d=r.useCallback(()=>new Promise(t=>{let n=e.current;if(null==n)return t();n.scrollTo({to:Number.MAX_SAFE_INTEGER,callback:()=>requestAnimationFrame(()=>t())})}),[e]);return(0,u.ZP)({id:t,isEnabled:c,setFocus:a,scrollToStart:o,scrollToEnd:d,orientation:null==n?void 0:n.orientation})}},495437:function(t,e,n){n.d(e,{EB:function(){return l},Je:function(){return a},cf:function(){return c},mh:function(){return o}});var r=n(570140),u=n(881052),i=n(824389);let l=async t=>{r.Z.dispatch({type:"GUILD_PRODUCTS_FETCH",guildId:t});try{let e=await i.uV(t);r.Z.dispatch({type:"GUILD_PRODUCTS_FETCH_SUCCESS",guildId:t,products:e})}catch(e){r.Z.dispatch({type:"GUILD_PRODUCTS_FETCH_FAILURE",guildId:t})}},c=async(t,e)=>{r.Z.dispatch({type:"GUILD_PRODUCT_FETCH",productId:e});try{let n=await i.p9(t,e);return r.Z.dispatch({type:"GUILD_PRODUCT_FETCH_SUCCESS",product:n}),n}catch(t){throw r.Z.dispatch({type:"GUILD_PRODUCT_FETCH_FAILURE",productId:e,error:new u.Hx(t)}),t}};async function a(t,e,n){let u=await i.Je(t,e,n);return r.Z.dispatch({type:"GUILD_PRODUCT_UPDATE",product:u}),u}async function o(t,e){return await i.mh(t,e),r.Z.dispatch({type:"GUILD_PRODUCT_DELETE",productId:e}),!0}},267101:function(t,e,n){n.d(e,{SO:function(){return E},eD:function(){return _},hO:function(){return f},r:function(){return D},ue:function(){return C}}),n(47120);var r=n(470079),u=n(442837);n(935369);var i=n(38618),l=n(160404),c=n(496675),a=n(914010),o=n(495437),d=n(240864),s=n(981631);let _=t=>{let e=(0,u.e7)([d.Z],()=>null!=t?d.Z.getGuildProductsForGuildFetchState(t):d.M.FETCHED,[t]),n=(0,u.e7)([i.Z],()=>i.Z.isConnected()),[l,c]=r.useState(!0);return r.useEffect(()=>{l&&(e===d.M.NOT_FETCHED||e===d.M.FETCHED&&d.Z.isGuildProductsCacheExpired(t))&&n&&o.EB(t),c(!n)},[t,n,e,l]),{listingsLoaded:e===d.M.FETCHED&&!l}},f=function(t,e){let{requireCurrentGuild:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requireCurrentGuild:!0},l=(0,u.e7)([i.Z],()=>i.Z.isConnected()),c=(0,u.e7)([a.Z],()=>a.Z.getGuildId());return r.useEffect(()=>{let r=d.Z.getGuildProductFetchState(e);if((!n||c===t)&&l&&r===d.M.NOT_FETCHED)try{o.cf(t,e)}catch(t){}},[t,e,l,c,n]),(0,u.e7)([d.Z],()=>d.Z.getGuildProduct(e))},C=function(t){let{publishedOnly:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,u.e7)([d.Z,l.Z],()=>d.Z.getGuildProductsForGuild(t,{publishedOnly:null!=e?e:!l.Z.isViewingServerShop(t)}))},D=t=>(0,u.e7)([d.Z],()=>null==t?void 0:d.Z.getGuildProduct(t)),E=t=>(0,u.e7)([c.Z],()=>null!=t&&c.Z.can(s.Plq.ADMINISTRATOR,t))},824389:function(t,e,n){n.d(e,{Je:function(){return c},gs:function(){return s},mh:function(){return a},p9:function(){return d},uV:function(){return o}});var r=n(544891),u=n(881052),i=n(73346),l=n(981631);let c=async(t,e,n)=>{let{priceTier:i,imageName:c,createNewRole:a,unlinkRole:o,...d}=n;try{return(await r.tn.patch({url:l.ANM.GUILD_PRODUCT_LISTINGS(t,e),body:{...d,image_name:c,price_tier:i,create_new_role:a,unlink_role:o}})).body}catch(t){throw new u.Hx(t)}},a=async(t,e)=>{try{await r.tn.del({url:l.ANM.GUILD_PRODUCT_LISTINGS(t,e)})}catch(t){throw new u.Hx(t)}},o=async t=>{try{return(await (0,i.Kb)({url:l.ANM.GUILD_PRODUCT_LISTINGS(t)})).body.listings}catch(t){throw new u.Hx(t)}},d=async(t,e)=>{try{return(await (0,i.Kb)({url:l.ANM.GUILD_PRODUCT_LISTINGS(t,e)})).body}catch(t){throw new u.Hx(t)}},s=async t=>{let{guildId:e,productId:n,attachmentId:i}=t;try{return(await r.tn.post({url:l.ANM.GUILD_PRODUCT_ATTACHMENT_DOWNLOAD(e,n,i)})).body}catch(t){throw new u.Hx(t)}}},240864:function(t,e,n){n.d(e,{M:function(){return r}}),n(653041),n(47120);var r,u,i,l,c,a,o=n(442837),d=n(759174),s=n(570140),_=n(70956),f=n(709054);(i=r||(r={}))[i.NOT_FETCHED=0]="NOT_FETCHED",i[i.FETCHING=1]="FETCHING",i[i.FETCHED=2]="FETCHED";let C={},D={},E={},T=10*_.Z.Millis.MINUTE;function U(t){return"guild:".concat(t)}function h(t){return"guild:".concat(t,":published")}let P=new d.h(t=>{let e=[U(t.guild_id)];return t.published&&e.push(h(t.guild_id)),e},t=>(function(t){let e=f.default.extractTimestamp(t.id);return t.published?-e:-e+1e12})(t)),G=[];class p extends(u=o.ZP.Store){getGuildProductsForGuildFetchState(t){var e;return null!==(e=C[t])&&void 0!==e?e:0}getGuildProduct(t){return P.get(t)}getGuildProductsForGuild(t,e){let{publishedOnly:n}=e;return null==t?G:P.values(n?h(t):U(t))}getGuildProductFetchState(t){var e;return null!==(e=D[t])&&void 0!==e?e:0}isGuildProductsCacheExpired(t){var e;return Date.now()-(null!==(e=E[t])&&void 0!==e?e:0)>T}}a="GuildProductsStore",(c="displayName")in(l=p)?Object.defineProperty(l,c,{value:a,enumerable:!0,configurable:!0,writable:!0}):l[c]=a,e.Z=new p(s.Z,{CONNECTION_OPEN:function(){P.clear(),C={},D={},E={}},GUILD_PRODUCTS_FETCH:function(t){let{guildId:e}=t;C[e]=1,[...P.values(U(e))].forEach(t=>{P.delete(t.id)})},GUILD_PRODUCTS_FETCH_SUCCESS:function(t){let{guildId:e,products:n}=t;C[e]=2,E[e]=Date.now(),n.forEach(t=>{P.set(t.id,t),D[t.id]=2})},GUILD_PRODUCTS_FETCH_FAILURE:function(t){let{guildId:e}=t;C[e]=2},GUILD_PRODUCT_CREATE:function(t){let{product:e}=t;P.set(e.id,e)},GUILD_PRODUCT_UPDATE:function(t){let{product:e}=t;P.set(e.id,e)},GUILD_PRODUCT_DELETE:function(t){let{productId:e}=t;P.delete(e)},GUILD_PRODUCT_FETCH:function(t){let{productId:e}=t;D[e]=1},GUILD_PRODUCT_FETCH_SUCCESS:function(t){let{product:e}=t;D[e.id]=2,P.set(e.id,e)},GUILD_PRODUCT_FETCH_FAILURE:function(t){let{productId:e,error:n}=t;D[e]=2,404===n.status&&P.delete(e)}})},942833:function(t,e,n){n.d(e,{C:function(){return l},k:function(){return c}});var r=n(470079),u=n(937615),i=n(689938);function l(t){return r.useMemo(()=>{if(null==t)return;let e=null!=t.role_id,n=t.attachments_count>0;if(e&&n)return i.Z.Messages.GUILD_PRODUCT_CARD_TYPE_DOWNLOADABLE_AND_ROLE;if(e)return i.Z.Messages.GUILD_PRODUCT_CARD_TYPE_ROLE;if(n)return i.Z.Messages.GUILD_PRODUCT_CARD_TYPE_DOWNLOADABLE},[t])}function c(t){return r.useMemo(()=>{if((null==t?void 0:t.price)==null)return;let{amount:e,currency:n}=t.price;return(0,u.T4)(e,n)},[t])}},613810:function(t,e,n){var r=n(735250);n(470079);var u=n(481060);e.Z={open:function(t){(0,u.openModalLazy)(async()=>{let{default:e}=await n.e("53162").then(n.bind(n,490576));return n=>(0,r.jsx)(e,{...t,...n})})}}},499150:function(t,e,n){var r=n(735250),u=n(470079),i=n(481060),l=n(703656),c=n(981631);e.Z=u.forwardRef(function(t,e){let{href:n,children:a,onClick:o,onKeyPress:d,focusProps:s,..._}=t,f=u.useCallback(t=>{if(!t.repeat)(t.charCode===c.yXg.SPACE||t.charCode===c.yXg.ENTER)&&(t.preventDefault(),null!=n&&(0,l.uL)(n),null==o||o()),null==d||d(t)},[n,d,o]),C=u.useCallback(t=>{if(!t.metaKey&&!t.shiftKey&&0===t.button)t.preventDefault(),t.stopPropagation(),null!=n&&(0,l.uL)(n),null==o||o()},[n,o]),D=(0,r.jsx)("a",{ref:e,href:n,onClick:C,onKeyPress:f,..._,children:a});return(0,r.jsx)(i.FocusRing,{...s,children:D})})}}]);
//# sourceMappingURL=65392.fc4cdde8dd23dca1b896.js.map