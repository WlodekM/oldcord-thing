"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["95900"],{426831:function(e,n,s){e.exports=s.p+"f9e18e3049e471717cf2.svg"},257510:function(e,n,s){e.exports=s.p+"0e72033c60770cfc4a78.svg"},74838:function(e,n,s){e.exports=s.p+"fa9b1ae8d7c7ed9b1e89.svg"},720834:function(e,n,s){e.exports=s.p+"e907b5a0f29a0608596d.svg"},385925:function(e,n,s){e.exports=s.p+"13554545ee03bcb9526c.svg"},588921:function(e,n,s){e.exports=s.p+"8fbb9cda2bcb0b0f364f.svg"},718720:function(e,n,s){e.exports=s.p+"7cb4e15e625af682f6c9.svg"},721513:function(e,n,s){e.exports=s.p+"e5f5fbb464426907c65f.svg"},241822:function(e,n,s){e.exports=s.p+"a9a05015f7119a88c5bf.png"},190947:function(e,n,s){s.d(n,{b:function(){return r}});var l=s(735250);s(470079);var i=s(481060),t=s(991862);function r(e){let{currencies:n,className:s,children:i}=e;return n.length<2?null:(0,l.jsx)("div",{className:s,children:i})}n.Z=function(e){let{currencies:n,onChange:s,selectedCurrency:r,className:a,disabled:c=!1}=e;if(n.length<2)return null;let o=n.map((e,n)=>({key:n,value:e,label:"".concat(e.toUpperCase()," - ").concat((0,t.T)(e))}));return(0,l.jsx)(i.SingleSelect,{value:r,options:o,onChange:e=>{null!=e&&s(e)},className:a,isDisabled:c})}},86040:function(e,n,s){s.d(n,{C:function(){return c},N:function(){return o}});var l=s(735250);s(470079);var i=s(481060),t=s(285952),r=s(689938),a=s(162950);let c=e=>{let{className:n,isEmailResent:s,resendEmail:t}=e;return(0,l.jsx)("div",{className:n,children:(0,l.jsxs)("div",{className:a.awaitingWrapper,children:[(0,l.jsx)(i.Heading,{variant:"heading-xl/bold",children:r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_HEADER}),(0,l.jsxs)("p",{children:[(0,l.jsx)(i.Text,{variant:"text-md/normal",children:r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL}),(0,l.jsx)("br",{}),(0,l.jsx)(i.Text,{variant:"text-md/normal",children:r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_INSTRUCTIONS}),(0,l.jsx)("br",{}),(0,l.jsxs)(i.Text,{variant:"text-md/normal",children:[r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_PROMPT,"\xa0",s?r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_SENT:(0,l.jsx)(i.Anchor,{onClick:t,children:r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_ACTION})]})]})]})})},o=()=>(0,l.jsx)("div",{children:(0,l.jsx)(i.ModalFooter,{justify:t.Z.Justify.BETWEEN,align:t.Z.Align.CENTER,children:(0,l.jsx)(i.Button,{"data-testid":"continue",color:i.Button.Colors.BRAND,disabled:!0,children:r.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_NEXT_BUTTON})})})},620037:function(e,n,s){let l=(0,s(818083).B)({kind:"user",id:"2023-12_collectibles_gifting_dm_entrypoint",label:"Collectibles Gifting From DM's",defaultConfig:{confirmUpsellEnabled:!1},treatments:[{id:2,label:"Collectibles Gifting from DM's Enabled With Confirm Step Upsell",config:{confirmUpsellEnabled:!0}}]});n.Z=e=>{let{location:n,autoTrackExposure:s=!0,trackExposureOptions:i={}}=e;return l.useExperiment({location:n},{autoTrackExposure:s,trackExposureOptions:i})}},940824:function(e,n,s){var l=s(735250);s(470079);var i=s(481060),t=s(37234),r=s(100527),a=s(906732),c=s(703656),o=s(335131),u=s(981631),d=s(689938),_=s(677937);n.Z=e=>{let{onClose:n}=e,{analyticsLocations:s}=(0,a.ZP)(),m=()=>{n(),(0,c.uL)(u.Z5c.COLLECTIBLES_SHOP),(0,o.mK)({openInLayer:!1,analyticsSource:r.Z.PREMIUM_PAYMENT_MODAL,analyticsLocations:s}),(0,t.xf)()};return(0,l.jsxs)("div",{className:_.container,children:[(0,l.jsx)("div",{className:_.iconBackground,children:(0,l.jsx)(i.ShopIcon,{size:"custom",width:20,height:20,color:i.tokens.colors.WHITE})}),(0,l.jsx)(i.Text,{variant:"text-sm/normal",color:"header-primary",children:d.Z.Messages.COLLECTIBLES_GIFT_CODE_MODAL_UPSELL.format({checkItOut:e=>(0,l.jsx)(i.Clickable,{className:_.link,onClick:m,children:e})})})]})}},632580:function(e,n,s){s.d(n,{H:function(){return p}}),s(47120);var l=s(512722),i=s.n(l),t=s(570140),r=s(355467),a=s(976255),c=s(366939),o=s(16084),u=s(255078),d=s(626135),_=s(74538),m=s(45572),I=s(981631),E=s(474936);async function p(e){let{setPurchaseState:n,setHasAcceptedTerms:s,setIsSubmitting:l,setPurchaseError:p,hasRedirectURL:N,setHasRedirectURL:T,isGift:S,baseAnalyticsData:x,analyticsLocation:h,analyticsLocations:P,flowStartTime:A,subscriptionPlan:v,planGroup:f,trialId:M,priceOptions:g,paymentSource:C,isPrepaidPaymentPastDue:R,openInvoiceId:O,premiumSubscription:L,onNext:j,metadata:y,sku:Z,skuPricePreview:b,purchaseType:D,referralCode:G,loadId:U,giftInfoOptions:F,invoicePreview:w}=e;n(m.A.PURCHASING),s(!0),l(!0),t.Z.wait(a.fw),p(null);try{let e,s,l;if(d.default.track(I.rMx.PAYMENT_FLOW_COMPLETED,{...x,subtotal:null==w?void 0:w.subtotal,tax:null==w?void 0:w.tax,expected_amount:null==w?void 0:w.total,expected_currency:null==w?void 0:w.currency,duration_ms:Date.now()-A}),N)return;if(D===I.GZQ.ONE_TIME)i()(null!=Z,"SKU must exist and be fetched."),i()(null!=b,"SKUPricePreview must exist."),e=await (0,o.ZZ)(Z.applicationId,Z.id,{expectedAmount:b.amount,expectedCurrency:b.currency,isGift:S,paymentSource:C,loadId:U,giftInfoOptions:F});else if(i()(null!=v,"Missing subscriptionPlan"),S){i()(null!=w,"Missing invoicePreview");let n=w.total,s=w.currency;e=await (0,o.ZZ)(E.RQ,v.skuId,{expectedAmount:n,expectedCurrency:s,paymentSource:C,subscriptionPlanId:v.id,isGift:!0,loadId:U,giftInfoOptions:F})}else if(R&&null!=O&&null!=C&&null!=L)e=I.Uk1.has(C.type)?await (0,r.G)(L,O,C,g.currency):await (0,r.Mg)(L,{paymentSource:C,currency:g.currency},P,h,U);else if(null!=L){let n=(0,_.al)(L,v.id,1,new Set(f)),s={paymentSource:C,currency:g.currency};L.status===I.O0b.PAUSED?s.status=I.O0b.ACTIVE:s.items=n,e=await (0,r.Mg)(L,s,P,h,U)}else e=await (0,c.Ld)({planId:v.id,currency:g.currency,paymentSource:C,trialId:M,metadata:y,referralCode:G,loadId:U});if(e.redirectConfirmation){T(null!=e.redirectURL);return}n(m.A.COMPLETED),"subscription"in e?s=null!=e.subscription?u.Z.createFromServer(e.subscription):null:"entitlements"in e&&(l=null!=e.entitlements?e.entitlements:void 0),j(s,l)}catch(e){n(m.A.FAIL),p(e),d.default.track(I.rMx.PAYMENT_FLOW_FAILED,{...x,payment_error_code:null==e?void 0:e.code,payment_source_id:null==C?void 0:C.id,payment_source_type:null==C?void 0:C.type,duration_ms:Date.now()-A})}finally{!N&&l(!1)}}},276442:function(e,n,s){s.d(n,{J:function(){return E}});var l=s(512722),i=s.n(l),t=s(792986),r=s(639119),a=s(3409),c=s(626135),o=s(987209),u=s(598),d=s(409813),_=s(737143),m=s(981631),I=s(474936);function E(e){let{analyticsData:n,initialPlanId:s,breadcrumbSteps:l,handleStepChange:E,referralTrialOfferId:p,onReturn:N,continueSession:T=!1}=e,{contextMetadata:S,step:x,paymentSources:h,paymentSourceId:P,setPaymentSourceId:A,purchaseError:v,setPurchaseError:f,purchaseErrorBlockRef:M,paymentAuthenticationState:g,selectedSkuId:C,activeSubscription:R,previousStepRef:O}=(0,u.usePaymentContext)(),{isGift:L}=(0,o.wD)(),j={...(0,a.fL)(),paymentSources:h,paymentSourceId:P,setPaymentSourceId:A,purchaseError:v,setPurchaseError:f,purchaseErrorBlockRef:M,paymentAuthenticationState:g,selectedSkuId:C,isGift:L},y=(0,r.N)(p),Z=!L&&null!=y&&null!=C&&I.nG[y.trial_id].skus.includes(C),b=null!=N?N:()=>{E(Object.values(h).length<1&&null==s?d.h8.PLAN_SELECT:d.h8.REVIEW,{trackedFromStep:d.h8.PAYMENT_TYPE})};i()(x,"Step should be set here");let D=(0,t.Z)(()=>Date.now(),[x]);return(0,a.vP)({paymentModalArgs:j,initialStep:T&&null==O.current?d.h8.CREDIT_CARD_INFORMATION:d.h8.PAYMENT_TYPE,prependSteps:[d.h8.PROMOTION_INFO],appendSteps:[d.h8.REVIEW,d.h8.CONFIRM],breadcrumpSteps:l,currentBreadcrumpStep:x,usePaymentModalStep:!0,onReturn:b,onComplete:e=>{e===d.h8.AWAITING_BROWSER_CHECKOUT?E(d.h8.CONFIRM,{trackedFromStep:e}):E(d.h8.REVIEW,{trackedFromStep:e})},onStepChange:e=>{let{currentStep:s,toStep:l}=e,i=Date.now();c.default.track(m.rMx.PAYMENT_FLOW_STEP,{...n,from_step:s,to_step:l,step_duration_ms:i-D,flow_duration_ms:i-S.startTime})},isEligibleForTrial:Z,allowDesktopRedirectPurchase:(0,_.tr)(C,L,R)})}},793541:function(e,n,s){s.d(n,{Z:function(){return c}});var l=s(735250);s(470079);var i=s(723484),t=s(51499),r=s(614277),a=s(296836);function c(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.Z,{}),(0,l.jsx)(r.C3,{children:(0,l.jsx)(i.F,{className:a.awaitingAuthenticationStep})})]})}},380898:function(e,n,s){s.d(n,{Z:function(){return u}}),s(47120);var l=s(735250),i=s(470079),t=s(16084),r=s(86040),a=s(51499),c=s(614277),o=s(94250);function u(){let[e,n]=i.useState(!1),s=async()=>{n(!0),await (0,t.xA)()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Z,{}),(0,l.jsx)(c.C3,{children:(0,l.jsx)(r.C,{className:o.body,isEmailResent:e,resendEmail:s})}),(0,l.jsx)(c.O3,{children:(0,l.jsx)(r.N,{})})]})}},710094:function(e,n,s){s.d(n,{l:function(){return j}}),s(47120),s(411104);var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(330726),c=s(711459),o=s(424082),u=s(104494),d=s(639119),_=s(716534),m=s(664891),I=s(230927),E=s(911367),p=s(669079),N=s(987209),T=s(598),S=s(409813),x=s(45572),h=s(809144),P=s(698708),A=s(614223),v=s(481595),f=s(51499),M=s(678334),g=s(614277),C=s(981631),R=s(474936),O=s(231338),L=s(689938);function j(e){var n,s;let t,{handleStepChange:j,trialId:y,trialFooterMessageOverride:Z,reviewWarningMessage:b,planGroup:D,openInvoiceId:G,analyticsData:U,analyticsLocation:F,referralTrialOfferId:w,initialPlanId:B,subscriptionTier:H,handleClose:k}=e,{activeSubscription:W,setUpdatedSubscription:Y,contextMetadata:K,currencies:V,paymentSourceId:z,paymentSources:X,priceOptions:J,purchaseError:q,purchaseTokenAuthState:Q,selectedPlan:$,selectedSkuId:ee,setCurrency:en,setPaymentSourceId:es,setPurchaseState:el,setPurchaseError:ei,step:et,purchaseState:er,isPremium:ea,setHasAcceptedTerms:ec,purchaseType:eo,setEntitlementsGranted:eu,startedPaymentFlowWithPaymentSourcesRef:ed,invoicePreview:e_,setAnnualDiscountInvoicePreview:em}=(0,T.usePaymentContext)(),{isGift:eI,giftMessage:eE,giftRecipient:ep}=(0,N.wD)();r()(null!=et,"Step should be set");let eN=i.useRef(null),[eT,eS]=(0,a.Z)(!1,500);(0,E.t)();let ex=null!==(s=null!=y?y:w)&&void 0!==s?s:null,eh=null!=ex&&(!ea||R.nG[ex].skus.includes(ee))?ex:null,eP=(0,d.N)(w);(0,o.Uh)("PaymentModalReviewStep",null==eP);let eA=(0,u.Ng)(),ev={user_trial_offer_id:null==eP?void 0:eP.id};i.useEffect(()=>{null!=q&&null!=eN.current&&eN.current.scrollIntoView({behavior:"smooth"})},[q]);let ef=i.useCallback((e,n)=>{Y(e),null!=n&&eu(n),j(S.h8.CONFIRM,{fulfillment:{subscription:e,entitlements:n}})},[j,Y,eu]),eM=null!=z?X[z]:null,eg=null!=$&&R.o4.has($.id)&&null!=eM&&!(0,c.aQ)(eM)?Error(L.Z.Messages.BILLING_ERROR_INVALID_PLAN_FOR_PAYMENT_SOURCE):null,eC=i.useRef(null),[eR,eO]=i.useState(null),eL=!eI&&null!=eP&&null!=ee&&R.nG[eP.trial_id].skus.includes(ee),ej=null==eA?void 0:null===(n=eA.discount)||void 0===n?void 0:n.plan_ids,ey=!eI&&null!=eA&&null!=ej&&null!=$&&ej.includes($.id),eZ=er===x.A.PURCHASING||er===x.A.COMPLETED||(null==W?void 0:W.status)===C.O0b.PAUSED||null!=G,{annualInvoicePreview:eb}=(0,I.g)({priceOptions:J,preventFetch:eZ,selectedSkuId:ee,isGift:eI,planGroup:D,activeSubscription:W});null!=eb&&em(eb);let eD=eI&&(0,p.pO)(ep),eG=null==B&&null==H&&eo===O.GZ.SUBSCRIPTION,eU=(0,A.Kp)({isTrial:eL,isGift:eI,selectedSkuId:ee,startedPaymentFlowWithPaymentSources:ed.current}),eF=eI&&eo===O.GZ.ONE_TIME,ew=eF||(eU?eG&&ea:ea),eB=i.useCallback(()=>{if(eU){j(S.h8.SKU_SELECT);return}return eF?j(S.h8.GIFT_CUSTOMIZATION):j(S.h8.PLAN_SELECT)},[j,eU,eF]),eH=!1;return eo===O.GZ.ONE_TIME?t=(0,l.jsx)(v.Z,{hasLegalTermsFlash:eT,legalTermsNodeRef:eC,onPaymentSourceChange:e=>es(null!=e?e.id:null),handlePaymentSourceAdd:()=>j(S.h8.ADD_PAYMENT_STEPS)}):(eH=eI?null==e_:null!=eM&&eo===O.GZ.SUBSCRIPTION&&eL&&!eM.canRedeemTrial(),null==W||eI?(r()(null!=$,"Expected plan to be selected"),t=(0,l.jsx)(_.Z,{selectedPlanId:$.id,paymentSources:X,onPaymentSourceChange:e=>es(null!=e?e.id:null),priceOptions:J,currencies:V,onCurrencyChange:e=>en(e),handlePaymentSourceAdd:()=>j(S.h8.ADD_PAYMENT_STEPS),setHasAcceptedTerms:ec,legalTermsNodeRef:eC,hasLegalTermsFlash:eT,trialId:eh,trialFooterMessageOverride:Z,reviewWarningMessage:b,purchaseState:er,referralTrialOfferId:w,isTrial:eL||null!=y&&null!=Z,isDiscount:ey,handleClose:k})):(r()(null!=$,"Expected plan to be selected"),t=(0,l.jsx)(m.Z,{premiumSubscription:W,paymentSources:X,priceOptions:J,onPaymentSourceChange:e=>{es(null!=e?e.id:null)},onPaymentSourceAdd:()=>{j(S.h8.ADD_PAYMENT_STEPS)},planId:$.id,setHasAcceptedTerms:ec,legalTermsNodeRef:eC,hasLegalTermsFlash:eT,onInvoiceError:e=>eO(e),planGroup:D,currencies:V,onCurrencyChange:e=>en(e),hasOpenInvoice:null!=G,purchaseState:er,handleClose:k}))),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.P,{giftMessage:eE}),!eD&&(0,l.jsx)(f.Z,{isEligibleForTrial:eL}),(0,l.jsxs)(g.C3,{children:[(0,l.jsx)(P.Z,{}),t]}),(0,l.jsx)(g.O3,{children:(0,l.jsx)(M.Z,{premiumSubscription:null!=W?W:null,setPurchaseState:el,onBack:eB,onNext:ef,onPurchaseError:e=>ei(e),legalTermsNodeRef:eC,flashLegalTerms:()=>eS(!0),invoiceError:eR,planError:eg,analyticsLocation:F,baseAnalyticsData:U,flowStartTime:K.startTime,trialId:eh,planGroup:D,purchaseTokenAuthState:Q,openInvoiceId:G,backButtonEligible:ew,metadata:ev,isTrial:eL,disablePurchase:eH})})]})}},678334:function(e,n,s){s.d(n,{Z:function(){return O}}),s(47120);var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(442837),c=s(481060),o=s(355467),u=s(906732),d=s(160913),_=s(311821),m=s(459965),I=s(858987),E=s(975060),p=s(882712),N=s(855775),T=s(285952),S=s(626135),x=s(669079),h=s(74538),P=s(987209),A=s(598),v=s(632580),f=s(45572),M=s(919778),g=s(612853),C=s(981631),R=s(280755);function O(e){let{premiumSubscription:n,setPurchaseState:s,onBack:t,onNext:O,legalTermsNodeRef:L,flashLegalTerms:j,invoiceError:y,planError:Z,onPurchaseError:b,baseAnalyticsData:D,flowStartTime:G,trialId:U,planGroup:F,analyticsLocation:w,purchaseTokenAuthState:B,openInvoiceId:H,metadata:k,backButtonEligible:W,disablePurchase:Y,isTrial:K=!1}=e,{selectedPlan:V,priceOptions:z,setHasAcceptedTerms:X,setPurchaseError:J,purchaseType:q,paymentSourceId:Q,paymentSources:$,selectedSkuId:ee,skusById:en,skuPricePreviewsById:es,referralCode:el,contextMetadata:ei,invoicePreview:et}=(0,A.usePaymentContext)(),{isGift:er,selectedGiftStyle:ea,customGiftMessage:ec,emojiConfetti:eo,soundEffect:eu,giftRecipient:ed}=(0,P.wD)(),e_=(0,x.MY)(ed),em={};em.gift_style=ea,e_===x.xr.CUSTOM_MESSAGE_EMOJI_SOUNDBOARD&&(r()(null!=ed,"Gift recipient must be set at purchase review step for these gift options."),em.recipient_id=ed.id,em.custom_message=ec,em.emoji_id=null==eo?void 0:eo.id,em.emoji_name=(null==eo?void 0:eo.id)==null?null==eo?void 0:eo.surrogates:void 0,em.sound_id=null==eu?void 0:eu.soundId);let eI=null==V?void 0:V.id,eE=(0,M.sE)(U,z.paymentSourceId,eI),ep=(0,a.e7)([E.Z],()=>E.Z.popupCallbackCalled),{analyticsLocations:eN}=(0,u.ZP)(),eT=null!=Q?$[Q]:null,[eS,ex]=i.useState(eE),[eh,eP]=i.useState(!1),{hasEntitlements:eA}=(0,m.H)(eI,er),ev=(0,h.Ap)(z.paymentSourceId),ef=eA||eE,eM=(0,d.U)(),eg=null,eC=null;if(q===C.GZQ.ONE_TIME){var eR;r()(null!=ee,"SKU must be selected for one-time purchases"),eg=null!==(eR=en[ee])&&void 0!==eR?eR:null,r()(null!=eg,"SKU must exist and be fetched.");let e=es[ee],n=null!=Q?Q:N.c;eC=null!=e?e[n]:null}let eO=async()=>{await (0,v.H)({setPurchaseState:s,setHasAcceptedTerms:X,setIsSubmitting:ex,setPurchaseError:J,hasRedirectURL:eh,setHasRedirectURL:eP,isGift:er,baseAnalyticsData:D,analyticsLocation:w,analyticsLocations:eN,flowStartTime:G,subscriptionPlan:V,planGroup:F,trialId:U,priceOptions:z,paymentSource:eT,isPrepaidPaymentPastDue:eM,openInvoiceId:H,premiumSubscription:n,onNext:O,metadata:k,sku:eg,skuPricePreview:eC,purchaseType:q,referralCode:el,loadId:ei.loadId,giftInfoOptions:em,invoicePreview:et})};i.useEffect(()=>{(async()=>{if(!0===ep)try{if(null==E.Z.redirectedPaymentId)return;await (0,o.OP)(E.Z.redirectedPaymentId),s(f.A.COMPLETED),O()}catch(e){s(f.A.FAIL),b(e),S.default.track(C.rMx.PAYMENT_FLOW_FAILED,{...D,payment_error_code:null==e?void 0:e.code,payment_source_id:Q,payment_source_type:null==eT?void 0:eT.type,duration_ms:Date.now()-G})}finally{ex(!1),(0,o.K2)()}else B===p.I.SUCCESS&&await eO()})()},[ep]),i.useEffect(()=>{eE&&!er&&null==n&&eO()},[eE,er,n]);let eL=null!=H||q===C.GZQ.ONE_TIME&&!er;return eE?null:(0,l.jsxs)(c.ModalFooter,{align:T.Z.Align.CENTER,children:[(0,l.jsx)(I.Z,{legalTermsNodeRef:L,invoiceError:y,planError:Z,disablePurchase:Y,flashLegalTerms:j,isSubmitting:eS,premiumSubscription:n,isGift:er,planGroup:F,isPrepaid:ev,isTrial:K,makePurchase:eO,needsPaymentSource:null==eT&&!ef}),(0,l.jsx)(g.Z,{}),W&&!eL?(0,l.jsx)("div",{className:R.back,children:(0,l.jsx)(_.Z,{onClick:t})}):null]})}},919778:function(e,n,s){s.d(n,{sE:function(){return a}});var l=s(818083),i=s(74538);let t=(0,l.B)({kind:"user",id:"2022-06_no_payment_info_trial",label:"No Payment Info Trial",defaultConfig:{bypassCheckout:!1},treatments:[{id:1,label:"Bypass collecting payment info",config:{bypassCheckout:!0}}]}),r=(e,n,s)=>{let l=null==s||(0,i.uZ)(s);return null!=e&&null==n&&l},a=(e,n,s)=>{let{bypassCheckout:l}=t.useExperiment({location:"aeb070_1"},{autoTrackExposure:!1}),i=r(e,n,s);return l&&i}},809144:function(e,n,s){s.d(n,{P:function(){return u}});var l=s(735250);s(470079);var i=s(481060),t=s(609194),r=s(669079),a=s(987209),c=s(689938),o=s(130842);function u(e){let{giftMessage:n=c.Z.Messages.PREMIUM_PAYMENT_IS_GIFT}=e,{isGift:s,giftRecipient:u}=(0,a.wD)();return!s||(0,r.pO)(u)?null:(0,l.jsx)(t.Z,{className:o.paymentNote,iconSize:t.Z.Sizes.SMALL,icon:i.GiftIcon,color:null==n?t.Z.Colors.PRIMARY:t.Z.Colors.SECONDARY,children:n})}},481595:function(e,n,s){s.d(n,{Z:function(){return b}});var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(742280),c=s(399606),o=s(481060),u=s(224550),d=s(609194),_=s(275850),m=s(672971),I=s(115130),E=s(653798),p=s(314182),N=s(251660),T=s(246946),S=s(351402),x=s(855775),h=s(695103),P=s(366695),A=s(4912),v=s(669079),f=s(937615),M=s(987209),g=s(598),C=s(45572),R=s(119226),O=s(981631),L=s(689938),j=s(424416);function y(e){let{sku:n,skuPricePreview:s}=e;r()(null!=s.amount,"SKU must have a price set.");let i=s.amount-s.tax;return!s.tax_inclusive&&s.tax>0?(0,l.jsxs)(E.PO,{className:j.invoice,children:[(0,l.jsx)(E.R$,{label:n.name,value:(0,f.T4)(i,s.currency),className:j.subscriptionCostRow}),(0,l.jsx)(E.R$,{label:L.Z.Messages.PURCHASE_REVIEW_TAX_LABEL,value:(0,f.T4)(s.tax,s.currency),className:j.subscriptionCostRow}),(0,l.jsx)(E.KU,{}),(0,l.jsx)(E.Ji,{label:L.Z.Messages.BILLING_INVOICE_TOTAL.format(),value:(0,f.T4)(s.amount,s.currency),className:j.subscriptionCostRow})]}):(0,l.jsx)(E.PO,{className:j.invoice,children:(0,l.jsx)(E.R$,{label:n.name,value:(0,f.T4)(s.amount,s.currency),className:j.subscriptionCostRow})})}function Z(e){let{application:n,sku:s,isEmbeddedIAP:i}=e;return!0!==i?null:(0,l.jsxs)("div",{className:j.skuHeading,children:[(0,l.jsx)(P.Z,{game:n}),(0,l.jsx)(o.Heading,{variant:"heading-lg/bold",className:j.skuHeadingText,children:s.name})]})}function b(e){let{hasLegalTermsFlash:n,legalTermsNodeRef:s,onPaymentSourceChange:t,handlePaymentSourceAdd:P}=e,{application:f,purchaseState:b,paymentSources:D,paymentSourceId:G,setHasAcceptedTerms:U,skusById:F,skuPricePreviewsById:w,selectedSkuId:B,isEmbeddedIAP:H,purchaseType:k,purchasePreviewError:W}=(0,g.usePaymentContext)(),{isGift:Y,giftRecipient:K}=(0,M.wD)(),V=Y&&(0,v.pO)(K);r()(null!=B,"Expected selectedSkuId");let z=F[B],X=w[B],J=null!=G?G:x.c,q=null!=X?X[J]:null;r()(null!=z,"SKU must exist and be fetched."),r()(null!=f,"Application must exist.");let Q=(0,c.e7)([I.Z,h.Z],()=>h.Z.inTestModeForApplication(f.id)||I.Z.inDevModeForApplication(f.id),[f.id]),$=(0,c.e7)([T.Z],()=>T.Z.enabled),ee=a.M.EEA_COUNTRIES.has(S.Z.ipCountryCodeWithFallback),en=b===C.A.PURCHASING||b===C.A.COMPLETED,es=null!=G?D[G].type:null,el=i.useMemo(()=>null!=q?(0,l.jsx)(y,{sku:z,skuPricePreview:q}):null==W?(0,l.jsx)(o.Spinner,{type:o.Spinner.Type.WANDERING_CUBES,className:j.invoiceSpinner}):(0,l.jsx)(E.PO,{className:j.invoice,children:(0,l.jsx)(E.R$,{label:z.name,value:null,className:j.subscriptionCostRow})}),[W,z,q]);return(0,l.jsxs)("div",{className:j.stepBody,children:[Q&&(0,l.jsx)(d.Z,{icon:(0,o.makeIconCompat)(A.Z),iconSize:d.Z.Sizes.SMALL,color:d.Z.Colors.WARNING,className:j.errorBlock,children:L.Z.Messages.APPLICATION_STORE_PURCHASE_TEST_MODE},"TEST_MODE"),(0,l.jsx)(Z,{application:f,sku:z,isEmbeddedIAP:H}),V&&(0,l.jsx)(R.Z,{sku:z}),null!=K?(0,l.jsx)(N.s,{giftRecipient:K}):null,(0,l.jsx)(o.FormTitle,{tag:o.FormTitleTags.H5,children:Y?L.Z.Messages.PREMIUM_GIFTING_BUTTON:L.Z.Messages.ONE_TIME_PURCHASE_REVIEW_STEP_PURCHASE_DETAILS_LABEL}),el,(0,l.jsxs)("div",{className:j.paymentSourceWrapper,children:[(0,l.jsx)(o.FormTitle,{tag:o.FormTitleTags.H5,children:L.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,l.jsx)(_.Z,{paymentSources:Object.values(D),selectedPaymentSourceId:G,onChange:t,onPaymentSourceAdd:P,hidePersonalInformation:$})]}),(0,l.jsx)(p.Z,{isActive:n,ref:s,children:(0,l.jsx)(m.Z,{onChange:U,forceShow:!0,showWithdrawalWaiver:ee,disabled:en,subscriptionPlan:null,finePrintClassname:j.fineprint,purchaseType:k,isGift:Y,checkboxLabel:z.productLine===O.POd.COLLECTIBLES?L.Z.Messages.BILLING_LEGAL_MUMBO_JUMBO_TERMS_LABEL_SIMPLE.format({paidURL:O.EYA.PAID_TERMS}):void 0,finePrint:(0,l.jsx)(u.Z,{paymentSourceType:es,isEmbeddedIAP:H,purchaseType:k,productLine:z.productLine,isGift:Y})})})]})}},119226:function(e,n,s){s.d(n,{Z:function(){return P}}),s(627341);var l=s(735250);s(470079);var i=s(278074),t=s(979554),r=s(481060),a=s(1585),c=s(125988),o=s(583434),u=s(479446),d=s(981632),_=s(731896),m=s(680295),I=s(998502),E=s(987209),p=s(689938),N=s(463597),T=s(241822);let S=I.ZP.getEnableHardwareAcceleration()?r.AnimatedAvatar:r.Avatar;function x(e){let{avatarDecoration:n}=e,{avatarDecorationSrc:s,eventHandlers:i,avatarPlaceholderSrc:t}=(0,c.Z)({avatarDecorationOverride:n,size:(0,a.y9)(r.AvatarSizes.SIZE_152)});return(0,l.jsx)("div",{className:N.giftMainAnimationWrapper,children:(0,l.jsx)(S,{...i,avatarDecoration:s,src:t,className:N.avatar,size:r.AvatarSizes.SIZE_152,"aria-label":p.Z.Messages.USER_SETTINGS_AVATAR})})}function h(e){var n;let{id:s}=e,i=null===(n=(0,_.V)(s))||void 0===n?void 0:n.config;return(0,l.jsxs)("div",{className:N.profileEffectContainer,children:[(0,l.jsx)("img",{src:T,alt:null==i?void 0:i.accessibilityLabel,className:N.profileEffectBackground}),(0,l.jsx)(m.Z,{profileEffectId:s})]})}function P(e){let{sku:n}=e,{selectedGiftStyle:s}=(0,E.wD)(),{product:r}=(0,o.T)(null==n?void 0:n.id),a=null==r?void 0:r.items[0],c=(0,i.EQ)(a).with({type:t.Z.AVATAR_DECORATION},e=>(0,l.jsx)(x,{avatarDecoration:e})).with({type:t.Z.PROFILE_EFFECT},e=>(0,l.jsx)(h,{id:e.id})).otherwise(()=>null);return null!=s&&null==c?(0,l.jsx)("div",{className:N.giftMainAnimationWrapper,children:(0,l.jsx)(d.Z,{defaultAnimationState:u.S.LOOP,giftStyle:s,shouldAnimate:!0,className:N.__invalid_giftMainAnimation})}):c}},631818:function(e,n,s){var l=s(818083);n.Z=(0,l.B)({kind:"user",id:"2022-12_localized_pricing_poland_notice",label:"Localized Pricing Poland Notice",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Enable Poland Notice",config:{enabled:!0}}]})},987033:function(e,n,s){var l=s(818083);n.Z=(0,l.B)({kind:"user",id:"2023-05_localized_pricing_turkey_notice",label:"Localized Pricing Turkey Notice",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Enable Turkey Notice",config:{enabled:!0}}]})},711459:function(e,n,s){s.d(n,{aQ:function(){return a}}),s(47120);var l=s(742280),i=s(818083),t=s(474936);n.ZP=(0,i.B)({kind:"user",id:"2022-02_multi_month_plans",label:"Multi Month Plans",defaultConfig:{newPlans:[]},treatments:[{id:1,label:"3 and 6 Month Plans",config:{newPlans:[t.Xh.PREMIUM_6_MONTH_TIER_2,t.Xh.PREMIUM_3_MONTH_TIER_2]}},{id:2,label:"3 Month Plan Only",config:{newPlans:[t.Xh.PREMIUM_3_MONTH_TIER_2]}}]});let r=new Set([l.S.US,l.S.CA]);function a(e){return null==e||r.has(e.country)}},160913:function(e,n,s){s.d(n,{U:function(){return _}});var l=s(913527),i=s.n(l),t=s(442837),r=s(853872),a=s(509545),c=s(78839),o=s(74538),u=s(981631),d=s(231338);function _(){let e=(0,t.e7)([c.ZP],()=>c.ZP.getPremiumTypeSubscription()),n=(0,t.e7)([a.Z],()=>null!=e&&null!=e.planIdFromItems?a.Z.get(null==e?void 0:e.planIdFromItems):null),s=(0,t.e7)([r.Z],()=>null!=e&&null!=e.paymentSourceId?r.Z.getPaymentSource(e.paymentSourceId):null,[e]),l=null!=s&&d.Uk.has(s.type),_=(null==e?void 0:e.status)===u.O0b.PAST_DUE?i()().diff(i()(e.currentPeriodStart),"days"):0;return!!(null!=e&&null!=n&&(0,o.uZ)(n.id))&&l&&_>=0&&_<=(0,o.lY)(e).days&&e.status===u.O0b.PAST_DUE&&!e.isPurchasedExternally}},55610:function(e,n,s){s.d(n,{U:function(){return p}});var l=s(735250);s(470079);var i=s(120356),t=s.n(i),r=s(512722),a=s.n(r),c=s(481060),o=s(63063),u=s(631818),d=s(987033),_=s(53900),m=s(981631),I=s(689938),E=s(863962);function p(){let e=(0,_.Z)(),{enabled:n}=u.Z.useExperiment({location:"5ebfcf_1"},{autoTrackExposure:!1}),{enabled:s}=d.Z.useExperiment({location:"5ebfcf_2"},{autoTrackExposure:!1});return null!=e&&("PL"===e?n:"TR"===e&&s)}n.Z=e=>{var n,s;let{fromBoostCancelModal:i,className:r}=e,u=(0,_.Z)();if(!p())return null;return a()(null!=u,"Subscription billing country should not be null"),(0,l.jsxs)("div",{className:t()(E.noticeRoot,r),children:[(0,l.jsx)("div",{className:E.iconContainer,children:(0,l.jsx)(c.CircleExclamationPointIcon,{size:"custom",width:20,height:20,color:"currentColor",className:E.infoIcon})}),(0,l.jsx)("div",{className:E.text,children:(n=u,s=i,"PL"===n?s?I.Z.Messages.LOCALIZED_PRICING_PLN_LEGACY_PRICING_BOOST_WARNING:I.Z.Messages.LOCALIZED_PRICING_PLN_LEGACY_PRICING_WARNING:"TR"===n?s?I.Z.Messages.LOCALIZED_PRICING_TRY_LEGACY_PRICING_BOOST_WARNING:I.Z.Messages.LOCALIZED_PRICING_TRY_LEGACY_PRICING_WARNING:s?I.Z.Messages.LOCALIZED_PRICING_LEGACY_PRICING_BOOST_WARNING:I.Z.Messages.LOCALIZED_PRICING_LEGACY_PRICING_WARNING).format({helpCenterLink:o.Z.getArticleURL(m.BhN.LOCALIZED_PRICING)})})]})}},927699:function(e,n,s){s.d(n,{Z:function(){return T}}),s(47120);var l=s(735250),i=s(470079),t=s(120356),r=s.n(t),a=s(481060),c=s(541716),o=s(752305),u=s(893718),d=s(993413),_=s(131704),m=s(474936),I=s(981631),E=s(689938),p=s(190949);let N=(0,_.kt)({id:"1",type:I.d4z.DM});function T(e){let{sectionTitle:n,errors:s,onTextChange:t,pendingText:_,placeholder:I,currentText:T,className:S,innerClassName:x,disabled:h=!1,disableThemedBackground:P=!1}=e,[A,v]=i.useState(null!=_?_:T),[f,M]=i.useState((0,o.JM)(A)),g=i.useRef(!1);return i.useEffect(()=>{g.current=!0},[]),i.useEffect(()=>{if(void 0===_){let e=(0,o.JM)(T);v(T),M(e)}},[_,T]),(0,l.jsx)("div",{className:r()(p.body,S),children:(0,l.jsxs)(d.Z,{title:n,errors:s,disabled:h,children:[(0,l.jsx)(u.Z,{innerClassName:r()(p.textArea,x),editorClassName:p.editorTextArea,maxCharacterCount:m.$n,onChange:function(e,n,s){n!==A&&(v(n),M(s),t(n))},placeholder:I,channel:N,textValue:A,richValue:f,type:c.I.CUSTOM_GIFT,onBlur:()=>{g.current=!1},onFocus:()=>{g.current=!0},focused:g.current,onSubmit:function(){return new Promise(e=>{e({shouldClear:!1,shouldRefocus:!0})})},disableThemedBackground:P}),(0,l.jsx)(a.HiddenVisually,{children:E.Z.Messages.MAXIMUM_LENGTH.format({maxLength:m.$n})})]})})}},987716:function(e,n,s){s.d(n,{q:function(){return N}}),s(47120);var l=s(735250),i=s(470079),t=s(481060),r=s(987209),a=s(321051),c=s(669079),o=s(479446),u=s(646476),d=s(981632),_=s(96848),m=s(703926),I=s(474936),E=s(689938),p=s(421383);let N=e=>{let{isShopGift:n}=e,{giftRecipient:s,selectedGiftStyle:N,setSelectedGiftStyle:T,emojiConfetti:S,soundEffect:x,setEmojiConfetti:h,setSoundEffect:P}=(0,r.wD)(),[A,v]=i.useState(!1),f=i.useRef(null),M=(0,t.useRadioGroup)({orientation:"horizontal"}),g=(0,c.MY)(s,n),C=g===c.xr.CUSTOM_MESSAGE_EMOJI_SOUNDBOARD,R=g!==c.xr.DEFAULT,O=(0,u.rK)(),{enabled:L}=u.ZP.useExperiment({location:"premiumGiftSelect_GiftAnimationOptions"},{autoTrackExposure:O}),j=null;return R&&(j=O&&L?I.V4:I.QI),(0,l.jsxs)("div",{children:[R&&(0,l.jsxs)("div",{className:p.giftMainAnimation,children:[null!=N?(0,l.jsx)(d.Z,{giftStyle:N,defaultAnimationState:o.S.ACTION,idleAnimationState:o.S.LOOP,shouldAnimate:!0,className:p.animation}):(0,l.jsx)(t.Spinner,{className:p.spinner}),C&&(0,l.jsxs)("div",{className:p.soundEmojiContainer,children:[(0,l.jsx)("div",{className:p.sound,children:(0,l.jsx)(a.Z,{sound:x,onSelect:e=>{null!=P&&P(null==e?void 0:e)}})}),(0,l.jsx)("div",{className:p.emoji,children:(0,l.jsx)(_.Z,{setEmojiConfetti:h,emojiConfetti:null==S?void 0:S})})]})]}),(0,l.jsx)("div",{tabIndex:null!=N||A?void 0:0,onFocus:e=>{var n;e.target===e.currentTarget&&(null===(n=f.current)||void 0===n||n.focus())},className:p.giftBoxOptionContainer,"aria-label":E.Z.Messages.SEASONAL_GIFTING_CUSTOMIZE_YOUR_GIFT_BOX,...M,children:null!=j&&j.map((e,n)=>(0,l.jsx)(m.m,{isSelected:N===e,giftStyle:e,setSelectedGiftStyle:T,ref:0===n?f:null,onFocus:()=>v(!0),onBlur:()=>v(!1)},e))}),(0,l.jsx)("div",{className:p.__invalid_selectPlanDivider})]})}},96848:function(e,n,s){s.d(n,{Z:function(){return m}}),s(47120),s(757143);var l=s(735250),i=s(470079),t=s(481060),r=s(907040),a=s(981631),c=s(185923),o=s(689938),u=s(197013);let d={section:a.jXE.VOICE_CHANNEL_EFFECTS_EMOJI_PICKER,openPopoutType:"gift_effect_emoji_picker"},_=c.Hz.GIFT;function m(e){let{setEmojiConfetti:n,emojiConfetti:s}=e,[a,c]=i.useState(!1),m=e=>(0,l.jsxs)("div",{className:u.customGiftContent,children:[(0,l.jsxs)("div",{className:u.customGiftHeader,children:[(0,l.jsx)(t.Text,{variant:"text-md/bold",children:o.Z.Messages.GIFT_SELECT_EMOJI}),(0,l.jsx)(t.Text,{variant:"text-sm/normal",children:o.Z.Messages.GIFT_SELECT_SOUNDBOARD_OR_EMOJI_DESCRIPTION})]}),e]}),I=e=>{null!=n&&(n(e),c(!1))};return(0,l.jsx)(t.Popout,{shouldShow:a,position:"bottom",align:"left",autoInvert:!1,onRequestClose:()=>c(!1),renderPopout:e=>{let{closePopout:n}=e;return(0,l.jsx)(t.Dialog,{children:(0,l.jsx)(r.Z,{analyticsOverride:d,closePopout:n,onSelectEmoji:I,wrapper:"div",pickerIntention:_,renderHeader:m,headerClassName:u.emojiHeader,className:u.emojiList,listHeaderClassName:u.emojiList,searchProps:{accessory:(0,l.jsx)(l.Fragment,{})}})})},children:()=>(0,l.jsx)("div",{className:u.container,children:(0,l.jsx)(t.Clickable,{className:u.emoji,onClick:()=>c(!0),children:(null==s?void 0:s.name)==null?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.ReactionIcon,{size:"custom",color:"currentColor",className:u.emojiIcon,width:14,height:14}),(0,l.jsx)(t.Text,{className:u.text,variant:"text-sm/semibold",children:o.Z.Messages.GIFT_SELECT_EMOJI})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.Text,{className:u.textSelected,variant:"text-sm/semibold",children:null==s.guildId?s.optionallyDiverseSequence:null}),(0,l.jsx)(t.Text,{className:u.text,variant:"text-sm/semibold",children:s.name.replace(/_/g," ")})]})})})})}},703926:function(e,n,s){s.d(n,{m:function(){return N}});var l=s(735250),i=s(470079),t=s(481060),r=s(474936),a=s(273912),c=s(426831),o=s(257510),u=s(74838),d=s(720834),_=s(385925),m=s(588921),I=s(718720),E=s(721513);let p={[r.Cj.STANDARD_BOX]:_,[r.Cj.CAKE]:m,[r.Cj.CHEST]:I,[r.Cj.COFFEE]:E,[r.Cj.SNOWGLOBE]:"",[r.Cj.BOX]:"",[r.Cj.CUP]:"",[r.Cj.SEASONAL_CAKE]:o,[r.Cj.SEASONAL_CHEST]:u,[r.Cj.SEASONAL_COFFEE]:d,[r.Cj.SEASONAL_STANDARD_BOX]:c},N=i.forwardRef(function(e,n){let{isSelected:s,giftStyle:i,setSelectedGiftStyle:r,onFocus:c,onBlur:o}=e;return(0,l.jsx)(t.Clickable,{innerRef:n,onClick:()=>r(i),onFocus:c,onBlur:o,children:(0,l.jsx)("img",{style:{width:"100%",height:"100%"},alt:"",src:p[i],className:s?a.customGiftBoxHighlighted:a.customGiftBox})})})},314404:function(e,n,s){s.d(n,{M:function(){return B},O:function(){return w}}),s(47120);var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(442837),c=s(481060),o=s(490504),u=s(911969),d=s(620037),_=s(940824),m=s(987209),I=s(598),E=s(409813),p=s(509545),N=s(78839),T=s(669079),S=s(63063),x=s(74538),h=s(937615),P=s(711459),A=s(847903),v=s(104494),f=s(639119),M=s(55610),g=s(653798),C=s(553797),R=s(927699),O=s(987716),L=s(311821),j=s(459965),y=s(811616),Z=s(251660),b=s(474936),D=s(981631),G=s(231338),U=s(689938),F=s(988775);function w(e){var n,s,t,E,N,L,j,w;let{premiumSubscription:B,skuId:H,selectedPlanId:k,setSelectedPlanId:W,priceOptions:Y,planOptions:K,eligibleForMultiMonthPlans:V,referralTrialOfferId:z,subscriptionPeriodEnd:X,showTotal:J=!0,discountInvoiceItems:q,handleClose:Q}=e,{activeSubscription:$,setSelectedPlanId:ee,selectedSkuId:en,selectedPlan:es,priceOptions:el,annualDiscountInvoicePreview:ei}=(0,I.usePaymentContext)(),{isGift:et,giftRecipient:er,selectedGiftStyle:ea,customGiftMessage:ec,setCustomGiftMessage:eo}=(0,m.wD)(),eu=(0,T.MY)(er),ed=et&&(0,T.pO)(er),{confirmUpsellEnabled:e_}=(0,d.Z)({location:"PremiumSwitchPlanSelectBody"});H=null!=H?H:en,B=null!=B?B:$,r()(void 0!==B,"should not be undefined");let[em,eI]=(0,a.Wu)([p.Z],()=>[null!=B?p.Z.get(B.planId):null,null!=k?p.Z.get(k):null]),eE=(0,f.N)(z),ep=null==eE?void 0:eE.subscription_trial,eN=(0,v.Ng)(),eT=(0,v.z1)(),eS=null==eN?void 0:null===(n=eN.discount)||void 0===n?void 0:n.plan_ids,ex=null!=eI?eI:es,eh=i.useCallback(e=>{null!=W?W(e):ee(e)},[W,ee]),eP=null!=Y?Y:el;r()(null!=eP,"Price option has to be set");let eA=null!=eE&&b.nG[eE.trial_id].skus.includes(H),ev=null!=eN&&K.some(e=>null==eS?void 0:eS.includes(e))&&null!=eN.discount,ef=null==eE&&(null==eT?void 0:eT.discount)!=null&&(null==ei?void 0:ei.invoiceItems)!=null&&K.some(e=>{var n,s;return null==eT?void 0:null===(s=eT.discount)||void 0===s?void 0:null===(n=s.plan_ids)||void 0===n?void 0:n.includes(e)}),eM=(0,x.aS)(b.Xh.PREMIUM_MONTH_TIER_2,!1,et,eP),eg=(0,x.aS)(b.Xh.PREMIUM_YEAR_TIER_2,!1,et,eP);i.useEffect(()=>{V&&P.ZP.trackExposure({location:"5f89bb_1"})},[V]);let eC=(null==ex?void 0:ex.id)!=null&&K.includes(ex.id);i.useEffect(()=>{if(!eC){if(null==em||et)eh(K[0]);else if(null!=em){let e=K.find(e=>e!==em.id);null!=e&&eh(e)}}},[eC,et,K,em,eh]);let eR=!ed&&(et||!eA&&!ev&&!ef)&&eC&&J,eO=(0,c.useRadioGroup)(),eL=(null==ex?void 0:ex.id)!=null?(0,x.aS)(ex.id,!1,et,eP):void 0,{ipCountryCode:ej}=(0,A.Z)(),ey="HR"===ej&&null!=eL&&eL.currency===G.pK.EUR,eZ=(0,x.Ap)(eP.paymentSourceId),eb=(null==ep?void 0:ep.interval)===b.rV.DAY?U.Z.Messages.BILLING_TRIAL_2_WEEK_PERIOD:U.Z.Messages.BILLING_TRIAL_30_DAY_PERIOD,eD=!et&&(ev||ef||null!=ep&&eA&&null!=X),eG=null==q?void 0:null===(E=q.find(e=>e.subscriptionPlanId===b.Xh.PREMIUM_MONTH_TIER_2))||void 0===E?void 0:null===(t=E.discounts)||void 0===t?void 0:null===(s=t.find(e=>e.type===u.eW.SUBSCRIPTION_PLAN))||void 0===s?void 0:s.amount,eU=null==ei?void 0:null===(w=ei.invoiceItems)||void 0===w?void 0:null===(j=w.find(e=>e.subscriptionPlanId===b.Xh.PREMIUM_YEAR_TIER_2))||void 0===j?void 0:null===(L=j.discounts)||void 0===L?void 0:null===(N=L.find(e=>e.type===u.eW.SUBSCRIPTION_PLAN))||void 0===N?void 0:N.amount;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:ed?F.stepBodyCustomGift:F.stepBody,children:[(0,l.jsxs)("div",{className:ed?F.bodyColumnMiddle:void 0,children:[(0,l.jsx)(M.Z,{fromBoostCancelModal:!1,className:F.legacyPricingNotice}),ed&&null!=ea&&(0,l.jsx)(O.q,{})]}),(0,l.jsxs)("div",{className:ed?F.bodyColumnRight:void 0,children:[(0,l.jsx)(Z.s,{giftRecipient:er}),(()=>{if(eu===T.xr.CUSTOM_MESSAGE_EMOJI_SOUNDBOARD&&null!=eo)return(0,l.jsx)(R.Z,{sectionTitle:U.Z.Messages.GIFT_OPTIONAL_MESSAGE,onTextChange:e=>eo(e),pendingText:ec,currentText:ec})})(),null!=em&&!et&&null==eU&&(0,l.jsx)("div",{className:F.bodyText,children:function(e,n){let s=U.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_MONTH,l=U.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_1_YEAR,i=(()=>{switch(e.interval){case b.rV.YEAR:return s;case b.rV.MONTH:default:return l}})(),t=e.skuId;switch(n){case b.Si.TIER_0:switch(t){case b.Si.TIER_1:return U.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_1_TO_TIER_0;case b.Si.TIER_2:return U.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_0;default:return i}case b.Si.TIER_1:switch(t){case b.Si.TIER_0:return U.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_1;case b.Si.TIER_2:return U.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_1;default:return i}case b.Si.TIER_2:switch(t){case b.Si.TIER_0:case b.Si.TIER_1:return U.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_2;case b.Si.TIER_2:return e.interval===b.rV.MONTH?U.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_2_YEAR.format({numFreeGuildSubscriptions:b.cb}):i;default:return i}default:return i}}(em,H)}),((e,n,s,i)=>{if(ed)return(0,l.jsx)(c.FormTitle,{children:U.Z.Messages.GIFT_SUBSCRIPTION_SELECTION});if(!eD)return(0,l.jsx)("div",{className:F.selectPlanChooseTitle,children:U.Z.Messages.BILLING_SWITCH_PLAN_CHOOSE_ONE});if(n){let n=(null==e?void 0:e.trial_id)===b.a7;return(0,l.jsxs)("div",{children:[(0,l.jsx)(c.Text,{variant:"text-sm/normal",className:F.trialPlanSelectHeader,children:n?U.Z.Messages.REFERRAL_PROGRAM_PAYMENT_MODAL_COPY.format({endDate:X}):U.Z.Messages.BILLING_TRIAL_PAYMENT_MODAL_INFO.format({trialEnd:X,trialPeriod:eb})}),(0,l.jsx)("hr",{className:F.planSelectSeparator})]})}return s&&null!=eG&&null!=eM&&k===b.Xh.PREMIUM_MONTH_TIER_2?(0,l.jsxs)("div",{children:[(0,l.jsx)(c.Text,{variant:"text-sm/normal",className:F.trialPlanSelectHeader,children:U.Z.Messages.BILLING_DISCOUNT_PAYMENT_MODAL_INFO_GENERIC.format({numMonths:null==eN?void 0:eN.discount.user_usage_limit,discountedPrice:(0,h.T4)(eM.amount-eG,eM.currency),regularPrice:(0,h.T4)(eM.amount,eM.currency)})}),(0,l.jsx)("hr",{className:F.planSelectSeparator})]}):i&&null!=eU&&null!=eg&&k===b.Xh.PREMIUM_YEAR_TIER_2?(0,l.jsxs)("div",{children:[(0,l.jsx)(c.Text,{variant:"text-sm/normal",className:F.trialPlanSelectHeader,children:U.Z.Messages.BILLING_ANNUAL_DISCOUNT_PAYMENT_MODAL_INFO.format({discountedPrice:(0,h.T4)(eg.amount-eU,eg.currency),regularPrice:(0,h.T4)(eg.amount,eg.currency)})}),(0,l.jsx)("hr",{className:F.planSelectSeparator})]}):void 0})(eE,eA,ev,ef),(0,l.jsx)("div",{...eO,children:K.map(e=>(0,l.jsx)(y.Z,{planId:e,premiumSubscription:et?null:null!=B?B:null,selectPlan:eh,selected:(null==ex?void 0:ex.id)===e,priceOptions:eP,shouldShowUpdatedPaymentModal:eD,isEligibleForDiscount:ev,discountAmountOff:eG,isEligibleForAnnualDiscount:ef,annualDiscountAmountOff:eU,isEligibleForTrial:eA},e))}),(0,l.jsx)("div",{children:eR&&null!=ex&&null!=eL?(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:F.selectPlanDivider}),(0,l.jsx)(g.Ji,{label:U.Z.Messages.BILLING_PAYMENT_BREAKDOWN_TOTAL,value:(0,l.jsx)(C.Z,{price:eL.amount,currency:eL.currency,intervalType:et?null:ex.interval,intervalCount:ex.intervalCount,isPrepaidPaymentSource:eZ}),className:F.selectPlanTotalRow})]}):null}),ey&&(0,l.jsx)(o.Z,{message:U.Z.Messages.LOCALIZED_PRICING_HRK_EURO_WARNING.format({kunaPriceWithCurrency:(0,h.T4)(7.5345*eL.amount,G.pK.HRK)})}),!et&&!eD&&J&&(0,l.jsx)(o.Z,{message:U.Z.Messages.BILLING_FINAL_PRICE_MAY_CHANGE.format({documentationLink:S.Z.getArticleURL(D.BhN.LOCALIZED_PRICING)})}),e_&&et&&(0,l.jsx)(_.Z,{onClose:Q})]})]})})}function B(e){let{onStepChange:n,selectedPlanId:s,paymentSources:i,onBackClick:t,showBackButton:r,planOptions:a,shouldRenderUpdatedPaymentModal:o=!1,isTrial:u}=e,{paymentSources:d,selectedPlan:_}=(0,I.usePaymentContext)(),{isGift:E}=(0,m.wD)();return i=null!=i?i:d,s=null!=s?s:null==_?void 0:_.id,(0,l.jsxs)(l.Fragment,{children:[null!=s&&a.includes(s)?(0,l.jsx)(H,{paymentSources:i,onStepChange:n,selectedPlanId:s,isGift:E,shouldRenderUpdatedPaymentModal:o,isTrial:u}):(0,l.jsx)(c.Button,{disabled:!0,children:U.Z.Messages.SELECT}),r?(0,l.jsx)(L.Z,{onClick:t}):null]})}function H(e){let{onStepChange:n,selectedPlanId:s,isGift:i,paymentSources:t,shouldRenderUpdatedPaymentModal:r,isTrial:o}=e,u=(0,a.e7)([N.ZP],()=>N.ZP.getPremiumTypeSubscription()),{hasEntitlements:d}=(0,j.H)(s,i),_=null!=u&&null!=u.paymentSourceId||Object.keys(t).length>0||d&&!o;var m=r?U.Z.Messages.NEXT:U.Z.Messages.SELECT,I=E.h8.ADD_PAYMENT_STEPS;return _&&(I=E.h8.REVIEW),(0,l.jsx)(c.Button,{onClick:()=>n(I),children:m})}},811616:function(e,n,s){s.d(n,{Z:function(){return P}});var l=s(735250);s(470079);var i=s(120356),t=s.n(i),r=s(512722),a=s.n(r),c=s(442837),o=s(692547),u=s(481060),d=s(987209),_=s(706454),m=s(509545),I=s(669079),E=s(930153),p=s(74538),N=s(937615),T=s(104494),S=s(474936),x=s(689938),h=s(24812);function P(e){let{premiumSubscription:n,planId:s,selectPlan:i,selected:r,priceOptions:P,shouldShowUpdatedPaymentModal:A,isEligibleForDiscount:v,discountAmountOff:f,isEligibleForAnnualDiscount:M,annualDiscountAmountOff:g,isEligibleForTrial:C}=e,R=(0,c.e7)([_.default],()=>_.default.locale),O=(0,c.e7)([m.Z],()=>m.Z.get(s)),{isGift:L,giftRecipient:j}=(0,d.wD)(),y=L&&(0,I.pO)(j);a()(null!=O,"Missing subscriptionPlan");let Z=null!=n&&n.planId===s,b=Z||s===S.Xh.PREMIUM_MONTH_TIER_2&&null!=n&&[S.Xh.PREMIUM_YEAR_TIER_0,S.Xh.PREMIUM_YEAR_TIER_1].includes(n.planId),D=S.nH[s],G=(0,p.aS)(s,!1,L,P),U=(0,p.Ap)(P.paymentSourceId),F=null!=D&&!A,w=(0,T.Ng)(),B=(0,T.z1)(),H=M&&null!=g&&O.interval===S.rV.YEAR,k=O.interval===S.rV.YEAR?x.Z.Messages.BILLING_TRIAL_YEARLY_PRICE_AFTER_TRIAL:x.Z.Messages.BILLING_TRIAL_MONTHLY_PRICE_AFTER_TRIAL,W=()=>null!=D&&(0,l.jsx)(u.Text,{tag:"span",variant:"eyebrow",color:"always-white",className:h.planOptionDiscount,children:x.Z.Messages.BILLING_PLAN_SELECTION_DISCOUNT.format({discount:(0,E.T3)(R,D/100)})}),Y=()=>O.interval===S.rV.YEAR&&null!=n||F&&!Z?O.interval!==S.rV.YEAR||null==n||H?F&&!Z?W():void 0:(0,l.jsxs)("span",{className:h.planOptionMonthsFree,children:["(",x.Z.Messages.BILLING_SWITCH_PLAN_YEARLY_FREE_MONTHS,")"]}):null;return(0,l.jsxs)(u.Clickable,{role:y?"menuitem":"radio","aria-checked":r,tabIndex:r?0:-1,focusProps:{offset:{left:-4,right:-4,top:0,bottom:0}},onClick:b?void 0:()=>i(s),className:t()(h.planOptionClickableContainer,{[h.selectedPlan]:y&&r,[h.selectionBox]:y}),children:[(0,l.jsxs)("div",{className:t()(h.planOption,{[h.planOptionDisabled]:b}),children:[(0,l.jsxs)("div",{className:h.planOptionClickable,children:[!y&&(0,l.jsx)(u.Checkbox,{readOnly:!0,displayOnly:!0,value:r,shape:u.Checkbox.Shapes.ROUND,color:o.Z.unsafe_rawColors.BRAND_500.css,type:u.Checkbox.Types.INVERTED,className:h.planOptionCheckbox}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:t()(h.planOptionInterval,{[h.optionSelected]:r||y,[h.updatedOptionSelected]:A&&(r||y)}),children:[(0,p.L7)(O.interval,L,U,O.intervalCount,y,(0,p.Rd)(O.id)),y&&Y()]}),y&&(0,l.jsx)("div",{className:h.planOneTimeCost,children:x.Z.Messages.ONE_TIME_CHARGE.format({currencyAmount:(0,N.T4)(G.amount,G.currency)})})]}),Z&&(0,l.jsxs)("span",{className:h.planOptionCurrentPlan,children:["(",x.Z.Messages.BILLING_SWITCH_PLAN_CURRENT_PLAN,")"]}),!y&&Y()]}),A?(0,l.jsx)("div",{className:t()({[h.optionPriceSelected]:r}),children:H?(()=>{if(H){var e;let n=(0,E.T3)(R,S.sK[null!==(e=null==B?void 0:B.discount_id)&&void 0!==e?e:"DEFAULT"]);return(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end"},children:[(0,l.jsx)(u.Text,{variant:"eyebrow",color:"always-white",className:h.annualPlanOptionDiscount,children:x.Z.Messages.BILLING_PLAN_SELECTION_DISCOUNT.format({discount:n})}),x.Z.Messages.BILLING_TRIAL_PRICE_NOW.format({price:(0,N.T4)(G.amount-g,G.currency)})]})}return null})():x.Z.Messages.BILLING_TRIAL_PRICE_NOW.format({price:v&&null!=f&&O.interval===S.rV.MONTH?(0,N.T4)(G.amount-f,G.currency):C?(0,N.T4)(0,G.currency,{maximumFractionDigits:0}):(0,N.T4)(G.amount,G.currency)})}):(0,l.jsx)("div",{className:t()({[h.optionSelected]:r||y}),children:(0,N.T4)(G.amount,G.currency)})]}),A&&(0,l.jsx)("div",{className:h.planOptionSubtextContainer,children:(0,l.jsx)(u.Text,{variant:"text-md/normal",color:r?"text-normal":"interactive-normal",className:t()(h.planOptionSubtext,{[h.discountPlanOptionSubtext]:v||M}),children:(()=>{if(v&&null!=f&&O.interval===S.rV.MONTH){var e;return x.Z.Messages.BILLING_DISCOUNT_MONTHLY_PRICE_GENERIC.format({numMonths:null!==(e=null==w?void 0:w.discount.user_usage_limit)&&void 0!==e?e:S.rt,discountedPrice:(0,N.T4)(G.amount-f,G.currency),regularPrice:(0,N.T4)(G.amount,G.currency)})}if(M&&null!=g&&O.interval===S.rV.YEAR)return x.Z.Messages.BILLING_ANNUAL_DISCOUNT_YEARLY_PRICE_SUBTEXT.format({regularPrice:(0,N.T4)(G.amount,G.currency)});if(C)return k.format({price:(0,N.T4)(G.amount,G.currency)});else O.interval===S.rV.YEAR&&x.Z.Messages.BILLING_YEARLY_PLAN_SAVINGS.format({percent:D});return null})()})})]})}},251660:function(e,n,s){s.d(n,{s:function(){return o}});var l=s(735250);s(470079);var i=s(481060),t=s(700582),r=s(51144),a=s(689938),c=s(315611);let o=e=>{let{giftRecipient:n}=e;return null==n?null:(0,l.jsxs)("div",{className:c.content,children:[(0,l.jsx)(i.FormTitle,{children:a.Z.Messages.FORM_LABEL_SEND_TO}),(0,l.jsxs)("div",{className:c.giftRecipientInfo,children:[(0,l.jsx)(t.Z,{user:n,className:c.__invalid_giftRecipient,size:i.AvatarSizes.SIZE_20}),(0,l.jsx)(i.Heading,{className:c.giftRecipientName,variant:"text-md/normal",children:r.ZP.getName(n)}),(0,l.jsx)(i.Heading,{className:c.giftRecipientTag,variant:"text-md/normal",children:r.ZP.getUserTag(n)})]})]})}},716534:function(e,n,s){s.d(n,{Z:function(){return W}}),s(47120);var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(742280),c=s(442837),o=s(692547),u=s(481060),d=s(190947),_=s(224550),m=s(275850),I=s(672971),E=s(128069),p=s(987209),N=s(598),T=s(45572),S=s(919778),x=s(614223),h=s(246946),P=s(351402),A=s(509545),v=s(669079),f=s(74538),M=s(937615),g=s(479446),C=s(374649),R=s(424082),O=s(104494),L=s(639119),j=s(653798),y=s(314182),Z=s(981632),b=s(314404),D=s(42818),G=s(459965),U=s(251660),F=s(474936),w=s(981631),B=s(231338),H=s(689938),k=s(473571);function W(e){var n,s,t,W;let Y,K,V,{selectedPlanId:z,paymentSources:X,priceOptions:J,currencies:q,onCurrencyChange:Q,onPaymentSourceChange:$,handlePaymentSourceAdd:ee,setHasAcceptedTerms:en,legalTermsNodeRef:es,hasLegalTermsFlash:el,trialId:ei,trialFooterMessageOverride:et,reviewWarningMessage:er,metadata:ea,purchaseState:ec,hideSubscriptionDetails:eo,referralTrialOfferId:eu,isTrial:ed=!1,isDiscount:e_=!1,handleClose:em}=e,{isEmbeddedIAP:eI,activeSubscription:eE,selectedSkuId:ep,defaultPlanId:eN,isPremium:eT,startedPaymentFlowWithPaymentSourcesRef:eS,setInvoicePreview:ex,contextMetadata:eh}=(0,N.usePaymentContext)(),{isGift:eP,giftRecipient:eA,selectedGiftStyle:ev}=(0,p.wD)(),ef=(0,O.Ng)(),eM=(0,L.N)(eu);(0,R.Uh)("PremiumSubscriptionReview",null==eM);let eg=null==ef?void 0:null===(n=ef.discount)||void 0===n?void 0:n.plan_ids.some(e=>F.GP[e].skuId===ep),eC=!eP&&null!=ef&&null!=ep&&eg,eR=(0,c.e7)([A.Z],()=>A.Z.get(z));r()(null!=eR,"Missing plan");let eO=[{planId:eR.id,quantity:1}],eL=ec===T.A.PURCHASING||ec===T.A.COMPLETED,ej=eP||eL,[ey,eZ]=(0,C.ED)({items:eO,renewal:!1,preventFetch:ej,applyEntitlements:!0,paymentSourceId:J.paymentSourceId,currency:J.currency,trialId:ei,metadata:ea}),[eb,eD]=(0,C.ED)({items:eO,renewal:!0,preventFetch:ej,trialId:ei,paymentSourceId:J.paymentSourceId,currency:J.currency,metadata:ea}),[eG,eU]=(0,C.ED)({items:[{planId:F.Xh.PREMIUM_MONTH_TIER_2,quantity:1}],renewal:!0,preventFetch:!eC,trialId:ei,paymentSourceId:J.paymentSourceId,currency:J.currency,metadata:ea}),[eF,ew]=(0,C.o5)({paymentSourceId:J.paymentSourceId,skuId:ep,subscriptionPlanId:z,currency:J.currency,preventFetch:!eP||eL,loadId:eh.loadId});i.useEffect(()=>{ex(eF)},[ex,eF]);let eB=eP&&(0,v.pO)(eA),eH=null!==(W=null!==(t=null!=eZ?eZ:eD)&&void 0!==t?t:eU)&&void 0!==W?W:ew,ek=(0,c.e7)([h.Z],()=>h.Z.enabled),eW=J.paymentSourceId,{hasEntitlements:eY,entitlements:eK}=(0,G.H)(eR.id,eP),eV=(0,f.Ap)(J.paymentSourceId),ez=(0,S.sE)(ei,eW,z),eX=(0,x.Kp)({isTrial:ed,isGift:eP,selectedSkuId:ep,startedPaymentFlowWithPaymentSources:eS.current}),[eJ,eq]=i.useState(null==ey?void 0:ey.subscriptionPeriodEnd);i.useEffect(()=>{null==eJ&&eq(null==ey?void 0:ey.subscriptionPeriodEnd)},[null==ey?void 0:ey.subscriptionPeriodEnd,eJ]);let eQ=i.useMemo(()=>(0,f.V7)({skuId:ep,isPremium:eT,multiMonthPlans:[],currentSubscription:eE,isGift:eP,isEligibleForTrial:ed,defaultPlanId:eN,defaultToMonthlyPlan:!1}),[ep,eE,eP,eN,eT,ed]),e$=(0,x.$g)(eX,ey,eR);if(null!=eH){let e=eH.message;eH.code===E.SM.INVALID_CURRENCY_FOR_PAYMENT_SOURCE&&(e=H.Z.Messages.BILLING_ERROR_UNSUPPORTED_CURRENCY),K=(0,l.jsx)(u.FormErrorBlock,{children:e})}else if(eP&&null!=eF)V=(0,l.jsx)(D.e9,{plan:eR,className:k.invoice,isPrepaidPaymentSource:eV,isCustomGift:eB,invoicePreview:eF});else if(ed&&null!=ey)V=(0,l.jsxs)("div",{children:[(0,l.jsx)(j.KU,{negativeMarginTop:!0}),(0,l.jsxs)(j.PO,{className:k.invoice,children:[(0,l.jsxs)("div",{className:k.trialPriceLine,children:[(0,l.jsx)(u.Text,{variant:"text-md/bold",children:H.Z.Messages.BILLING_PAYMENT_BREAKDOWN_TOTAL}),(0,l.jsx)(u.Text,{variant:"text-md/normal",children:H.Z.Messages.BILLING_TRIAL_PRICE_NOW.format({price:(0,M.T4)(0,ey.currency,{maximumFractionDigits:0})})})]}),(0,l.jsx)("div",{className:k.afterTrialPriceLine,children:(0,l.jsx)(D.yT,{invoice:ey,plan:eR})})]})]});else{if(null==ey||null==eb||e$)return(0,l.jsx)("div",{className:k.spinnerWrapper,children:(0,l.jsx)(u.Spinner,{})});ed&&ey.subscriptionPeriodEnd!==eb.subscriptionPeriodEnd&&(Y=ey.subscriptionPeriodEnd),V=(0,l.jsxs)(j.PO,{className:k.invoice,children:[(0,l.jsx)(j.q9,{children:H.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,l.jsx)(D.Lu,{invoice:ey,newPlan:eR,isPrepaidPaymentSource:eV,referralTrialOfferId:eu}),eV?null:(0,l.jsx)(D.nd,{renewalInvoice:eb,isTrial:ed,priceOptions:J,overrideRenewalDate:Y,trialFooterMessageOverride:et,hideSubscriptionDetails:eo})]})}let e0=a.M.EEA_COUNTRIES.has(P.Z.ipCountryCodeWithFallback),{checkboxLabel:e1,checkboxClassname:e9,checkboxLabelClassname:e4}=function(e,n,s){let l=null,i=null,t=null;if(e&&null!=n){let{intervalType:e,intervalCount:r}=f.ZP.getIntervalForInvoice(n),a=(0,M.og)((0,M.T4)(n.total,n.currency),e,r),c=null!=s?s:n.subscriptionPeriodEnd;l=H.Z.Messages.BILLING_LEGAL_MUMBO_JUMBO_TRIAL_TERMS_LABEL.format({termsURL:w.EYA.TERMS,paidURL:w.EYA.PAID_TERMS,rate:a,renewalDate:c}),i=k.trialCheckbox,t=k.trialCheckboxLabel}return{checkboxLabel:l,checkboxClassname:i,checkboxLabelClassname:t}}(null!=ed&&ed,eb,Y),e7=H.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:eR.name});return eP&&!eB?e7=H.Z.Messages.PAYMENT_MODAL_SUBTITLE_PREMIUM_GIFT:eP&&eB?e7="":(0,f.PV)(eR.id)&&(e7=f.ZP.getBillingReviewSubheader(null,eR)),ez?null:(0,l.jsxs)("div",{className:k.stepBody,children:[null!=er&&(0,l.jsxs)("div",{className:k.reviewWarningMessageContainer,children:[(0,l.jsx)(u.CircleInformationIcon,{size:"custom",color:o.Z.unsafe_rawColors.YELLOW_300.css,width:20,height:20}),(0,l.jsx)(u.Text,{className:k.reviewWarningMessage,variant:"text-sm/normal",children:er})]}),K,eX&&(0,l.jsxs)("div",{children:[(0,l.jsx)(j.KU,{negativeMarginTop:!0,negativeMarginBottom:!0}),(0,l.jsx)(b.O,{planOptions:eQ,eligibleForMultiMonthPlans:!1,referralTrialOfferId:void 0,selectedPlanId:z,subscriptionPeriodEnd:eJ,showTotal:!1,discountInvoiceItems:eC?null==eG?void 0:eG.invoiceItems:void 0,handleClose:em}),(0,l.jsx)(j.KU,{})]}),!ed&&(0,l.jsx)(u.FormTitle,{tag:u.FormTitleTags.H5,children:e7}),eB&&null!=ev&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z,{defaultAnimationState:g.S.LOOP,giftStyle:ev,shouldAnimate:!0,className:k.__invalid_giftMainAnimation}),(0,l.jsx)(U.s,{giftRecipient:eA})]}),V,(0,l.jsxs)("div",{className:k.paymentSourceWrapper,children:[ed?(0,l.jsx)(u.FormTitle,{tag:u.FormTitleTags.H5,className:k.formTitle,children:H.Z.Messages.BILLING_STEP_PAYMENT_METHOD}):(0,l.jsx)(u.FormTitle,{tag:u.FormTitleTags.H5,children:H.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,l.jsx)(m.Z,{paymentSources:Object.values(X),selectedPaymentSourceId:eW,prependOption:eY&&!ed?{label:H.Z.Messages.ATTACH_PAYMENT_SOURCE_PROMPT_OPTION_OPTIONAL,value:null}:null,onChange:$,onPaymentSourceAdd:ee,hidePersonalInformation:ek,isTrial:ed}),eY&&null==eW?(0,l.jsx)("div",{className:k.paymentSourceOptionalWarning,children:H.Z.Messages.ATTACH_PAYMENT_SOURCE_OPTIONAL_WITH_ENTITLEMENTS_WARNING.format({months:eK.length})}):null,e_?null:(0,l.jsxs)(d.b,{currencies:q,className:k.currencyWrapper,children:[(0,l.jsx)(u.FormTitle,{tag:u.FormTitleTags.H5,children:H.Z.Messages.PAYMENT_CURRENCY}),(0,l.jsx)(d.Z,{selectedCurrency:J.currency,currencies:q,onChange:Q})]})]}),(0,l.jsx)(y.Z,{isActive:el,ref:es,children:(0,l.jsx)(I.Z,{onChange:en,forceShow:!0,checkboxLabel:e1,checkboxClassname:e9,checkboxLabelClassname:e4,finePrint:null!=et?et:(0,l.jsx)(_.Z,{hide:ed||e_,subscriptionPlan:eR,renewalInvoice:eb,isGift:eP,paymentSourceType:null===(s=X[null!=eW?eW:""])||void 0===s?void 0:s.type,isEmbeddedIAP:eI,basePrice:(0,f.aS)(eR.id,!1,eP,J)}),showPricingLink:eR.currency!==B.pK.USD,showWithdrawalWaiver:e0,disabled:eL,isTrial:ed&&null==et,isDiscount:e_,subscriptionPlan:eR,isGift:eP})})]})}},664891:function(e,n,s){s.d(n,{Z:function(){return b}}),s(47120);var l=s(735250),i=s(470079),t=s(512722),r=s.n(t),a=s(742280),c=s(442837),o=s(481060),u=s(190947),d=s(224550),_=s(275850),m=s(672971),I=s(100527),E=s(906732),p=s(987209),N=s(598),T=s(45572),S=s(614223),x=s(246946),h=s(351402),P=s(509545),A=s(74538),v=s(296848),f=s(374649),M=s(653798),g=s(585602),C=s(314182),R=s(314404),O=s(42818),L=s(981631),j=s(689938),y=s(745566),Z=s(473571);function b(e){var n;let s,{premiumSubscription:t,paymentSources:I,priceOptions:E,onPaymentSourceChange:f,onPaymentSourceAdd:g,planId:O,setHasAcceptedTerms:y,legalTermsNodeRef:b,hasLegalTermsFlash:B,onInvoiceError:H,planGroup:k,currencies:W,onCurrencyChange:Y,hasOpenInvoice:K,purchaseState:V,handleClose:z}=e,{selectedSkuId:X,defaultPlanId:J,isPremium:q,startedPaymentFlowWithPaymentSourcesRef:Q,annualDiscountInvoicePreview:$}=(0,N.usePaymentContext)(),{isGift:ee}=(0,p.wD)(),en=E.paymentSourceId,es=(0,c.e7)([P.Z],()=>P.Z.get(O));r()(null!=es,"Missing newPlan");let el=(0,c.e7)([x.Z],()=>x.Z.hidePersonalInformation),ei=null!=$,et=a.M.EEA_COUNTRIES.has(h.Z.ipCountryCodeWithFallback),er=V===T.A.PURCHASING||V===T.A.COMPLETED,ea=(0,S.Kp)({isTrial:!1,isGift:ee,selectedSkuId:X,startedPaymentFlowWithPaymentSources:Q.current}),ec=(null==t?void 0:t.status)===L.O0b.PAUSED,eo=i.useMemo(()=>(0,A.V7)({skuId:X,isPremium:q,multiMonthPlans:[],currentSubscription:t,isGift:ee,isEligibleForTrial:!1,defaultPlanId:J,defaultToMonthlyPlan:!1}),[X,t,J,q,ee]);s=K||ec?j.Z.Messages.BILLING_PURCHASE_DETAILS_HEADER:(0,A.PV)(O)?(0,A.W_)(t,es):j.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:es.name});let eu=null;return null!=t&&(eu=K?(0,l.jsx)(D,{premiumSubscription:t,onInvoiceError:H,priceOptions:E,preventFetch:!1}):ec?(0,l.jsx)(F,{premiumSubscription:t,onInvoiceError:H,priceOptions:E,preventFetch:er}):(0,v.R4)(t,O,k)?(0,l.jsx)(G,{premiumSubscription:t,newPlan:es,onInvoiceError:H,planGroup:k,priceOptions:E,preventFetch:er,hasAnnualInvoicePreview:ei}):(0,l.jsx)(w,{premiumSubscription:t,newPlan:es,planGroup:k,priceOptions:E,preventFetch:er,hasAnnualInvoicePreview:ei})),(0,l.jsxs)("div",{className:Z.stepBody,children:[!ec&&ea&&(0,l.jsxs)("div",{children:[(0,l.jsx)(M.KU,{negativeMarginBottom:!0,negativeMarginTop:!0}),(0,l.jsx)(R.O,{planOptions:eo,eligibleForMultiMonthPlans:!1,selectedPlanId:O,showTotal:!1,handleClose:z}),(0,l.jsx)(M.KU,{})]}),(0,l.jsx)(o.FormTitle,{tag:o.FormTitleTags.H5,children:s}),eu,(0,l.jsxs)("div",{className:Z.paymentSourceWrapper,children:[(0,l.jsx)(o.FormTitle,{tag:o.FormTitleTags.H5,children:j.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,l.jsx)(_.Z,{paymentSources:Object.values(I),selectedPaymentSourceId:en,onChange:f,onPaymentSourceAdd:g,hidePersonalInformation:el,disabled:er})]}),(0,l.jsxs)(u.b,{currencies:W,className:Z.currencyWrapper,children:[(0,l.jsx)(o.FormTitle,{tag:o.FormTitleTags.H5,children:j.Z.Messages.PAYMENT_CURRENCY}),(0,l.jsx)(u.Z,{selectedCurrency:E.currency,currencies:W,onChange:Y,disabled:er})]}),(0,l.jsx)(C.Z,{isActive:B,ref:b,children:null!=t&&(0,v.R4)(t,O,k)?(0,l.jsx)(U,{premiumSubscription:t,newPlan:es,onInvoiceError:H,planGroup:k,priceOptions:E,preventFetch:er,disabled:er,isEEA:et,paymentSources:I,setHasAcceptedTerms:y,isGift:ee,hasAnnualDiscountPreview:null!=$}):(0,l.jsx)(m.Z,{onChange:y,finePrint:(0,l.jsx)(d.Z,{subscriptionPlan:es,paymentSourceType:null===(n=I[null!=en?en:""])||void 0===n?void 0:n.type,basePrice:(0,A.aS)(es.id,!1,ee,E),currentSubscription:t,planGroup:k}),forceShow:!0,showPricingLink:es.currency!==L.pKx.USD,showWithdrawalWaiver:et,disabled:er,subscriptionPlan:es,currentSubscription:t,planGroup:k})})]})}function D(e){let{premiumSubscription:n,onInvoiceError:s,priceOptions:t,preventFetch:r}=e,[a,c]=(0,f.Ox)({subscriptionId:n.id,preventFetch:r});i.useEffect(()=>{s(c)},[s,c]);let u=(0,A.Ap)(t.paymentSourceId);return null!=a?(0,l.jsxs)(M.PO,{className:y.__invalid_invoice,children:[(0,l.jsx)(O.By,{invoice:a,isPrepaidPaymentSource:u}),(0,l.jsx)(O.nd,{premiumSubscription:n,renewalInvoice:a,isUpdate:!0,isPrepaidPaymentSource:u})]}):(0,l.jsx)(o.Spinner,{})}function G(e){let{premiumSubscription:n,newPlan:s,onInvoiceError:t,planGroup:r,priceOptions:a,preventFetch:c,hasAnnualInvoicePreview:u}=e,{selectedSkuId:d,startedPaymentFlowWithPaymentSourcesRef:_}=(0,N.usePaymentContext)(),{isGift:m}=(0,p.wD)(),{analyticsLocations:T}=(0,E.ZP)(),x=(0,A.al)(n,s.id,1,new Set(r)),[h,P]=(0,f.ED)({subscriptionId:n.id,items:x,renewal:!1,applyEntitlements:!0,paymentSourceId:a.paymentSourceId,currency:a.currency,preventFetch:c,analyticsLocations:T,analyticsLocation:I.Z.BILLING_SWITCH_PLAN_IMMEDIATE_PRORATED_INVOICE_PREVIEW}),[v,g]=(0,f.ED)({subscriptionId:n.id,items:x,renewal:!0,paymentSourceId:a.paymentSourceId,currency:a.currency,preventFetch:c,analyticsLocations:T,analyticsLocation:I.Z.BILLING_SWITCH_PLAN_IMMEDIATE_RENEWAL_INVOICE_PREVIEW}),C=null!=P?P:g;if(i.useEffect(()=>{t(C)},[t,C]),null!=C)return(0,l.jsx)(o.FormErrorBlock,{children:C.message});let R=(0,S.Kp)({isTrial:!1,isGift:m,selectedSkuId:d,startedPaymentFlowWithPaymentSources:_.current}),L=(0,S.$g)(R,h,s);if(null==h||null==v||L)return(0,l.jsx)(o.Spinner,{className:Z.__invalid_spinner});let y=(0,A.Ap)(a.paymentSourceId);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.hG,{proratedInvoice:h,renewalInvoice:v}),(0,l.jsxs)(M.PO,{className:Z.invoice,children:[(0,l.jsx)(M.q9,{children:j.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,l.jsx)(O.Lu,{invoice:h,newPlan:s,isPrepaidPaymentSource:y}),(0,l.jsx)(O.nd,{premiumSubscription:n,proratedInvoice:h,renewalInvoice:v,isUpdate:!0,isPrepaidPaymentSource:y,hasAnnualInvoicePreview:u})]})]})}function U(e){var n,s;let t,{premiumSubscription:r,newPlan:a,onInvoiceError:c,planGroup:u,priceOptions:_,preventFetch:p,disabled:N,isEEA:T,paymentSources:S,setHasAcceptedTerms:x,isGift:h,hasAnnualDiscountPreview:P}=e,{analyticsLocations:v}=(0,E.ZP)(),M=(0,A.al)(r,a.id,1,new Set(u)),[g,C]=(0,f.ED)({subscriptionId:r.id,items:M,renewal:!0,paymentSourceId:_.paymentSourceId,currency:_.currency,preventFetch:p,analyticsLocations:v,analyticsLocation:I.Z.BILLING_SWITCH_PLAN_IMMEDIATE_RENEWAL_INVOICE_PREVIEW});return(i.useEffect(()=>{c(C)},[c,C]),null!=C)?(0,l.jsx)(o.FormErrorBlock,{children:C.message}):(null!=g&&(t={amount:g.total,currency:g.currency,tax:g.tax,taxInclusive:g.taxInclusive}),null==t)?null:(0,l.jsx)(m.Z,{onChange:x,finePrint:(0,l.jsx)(d.Z,{subscriptionPlan:a,paymentSourceType:null===(n=S[null!==(s=_.paymentSourceId)&&void 0!==s?s:""])||void 0===n?void 0:n.type,basePrice:P?(0,A.aS)(a.id,!1,h,_):t,currentSubscription:r,planGroup:u}),forceShow:!0,showPricingLink:a.currency!==L.pKx.USD,showWithdrawalWaiver:T,disabled:N,subscriptionPlan:a,currentSubscription:r,planGroup:u})}function F(e){let{premiumSubscription:n,priceOptions:s,preventFetch:t,onInvoiceError:r}=e,{analyticsLocations:a}=(0,E.ZP)(),[c,u]=(0,f.ED)({subscriptionId:n.id,renewal:!0,applyEntitlements:!0,paymentSourceId:s.paymentSourceId,currency:s.currency,preventFetch:t,analyticsLocations:a,analyticsLocation:I.Z.BILLING_PAUSED_SUBSCRIPTION_INVOICE_RESUME_PREVIEW}),[d,_]=(0,f.ED)({subscriptionId:n.id,renewal:!0,paymentSourceId:s.paymentSourceId,currency:s.currency,preventFetch:t,analyticsLocations:a,analyticsLocation:I.Z.BILLING_PAUSED_SUBSCRIPTION_INVOICE_RENEWAL_PREVIEW}),m=null!=u?u:_;if(i.useEffect(()=>{r(m)},[r,m]),null!=m)return(0,l.jsx)(o.FormErrorBlock,{children:m.message});if(null==c||null==d)return(0,l.jsx)(o.Spinner,{className:Z.__invalid_spinner});let p=(0,A.Ap)(s.paymentSourceId);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:y.renewalInvoiceDate,children:j.Z.Messages.BILLING_RESUME_PAUSED_SUBSCRIPTION_IMMEDIATELY}),(0,l.jsxs)(M.PO,{className:Z.invoice,children:[(0,l.jsx)(M.q9,{children:j.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,l.jsx)(O.By,{invoice:c,isPrepaidPaymentSource:p}),(0,l.jsx)(O.nd,{premiumSubscription:n,renewalInvoice:d,isUpdate:!0,isPrepaidPaymentSource:p})]})]})}function w(e){let n,{premiumSubscription:s,newPlan:i,planGroup:t,priceOptions:r,preventFetch:a,hasAnnualInvoicePreview:c}=e,{analyticsLocations:u}=(0,E.ZP)(),[d,_]=(0,f.ED)({subscriptionId:s.id,items:(0,A.al)(s,i.id,1,new Set(t)),renewal:!0,applyEntitlements:!1,paymentSourceId:r.paymentSourceId,currency:r.currency,preventFetch:a,analyticsLocations:u,analyticsLocation:"billing_switch_plan_renewal_mutation_renewal_invoice_preview"});if(null!=_)return(0,l.jsx)(o.FormErrorBlock,{children:_.message});if(null==d)return(0,l.jsx)("div",{children:(0,l.jsx)(o.Spinner,{})});n=s.type===L.NYc.PREMIUM?(0,A.Gf)(i.id):i.name;let m=(0,A.Ap)(r.paymentSourceId);return(0,l.jsxs)("div",{className:Z.bodyText,children:[(0,l.jsx)("div",{className:y.renewalInvoiceDate,children:j.Z.Messages.BILLING_SWITCH_PLAN_CHANGE_DATE.format({renewalDate:d.subscriptionPeriodStart})}),(0,l.jsxs)(M.PO,{className:Z.invoice,children:[(0,l.jsx)(M.q9,{children:j.Z.Messages.PREMIUM_SUBSCRIPTION_UPDATES}),(0,l.jsx)(M.R$,{label:n,value:(0,A.PK)(i,r,!0)}),(0,l.jsx)(g.Z,{invoice:d}),(0,l.jsx)(M.KU,{}),(0,l.jsx)(O.nd,{premiumSubscription:s,renewalInvoice:d,isUpdate:!0,isPrepaidPaymentSource:m,hasAnnualInvoicePreview:c})]})]})}},993413:function(e,n,s){s.d(n,{Z:function(){return _}}),s(757143);var l=s(735250);s(470079);var i=s(120356),t=s.n(i),r=s(481060),a=s(403182),c=s(587446),o=s(504983),u=s(3474);function d(e){let{errors:n}=e;return(0,l.jsx)(l.Fragment,{children:n.map((e,n)=>(0,l.jsx)(r.Text,{variant:"text-xs/normal",color:"text-danger",className:u.errorMessage,children:e.replace(/[0-9.,]+ ?kb/g,e=>{let n=1024*parseInt(e,10);return isNaN(n)?e:(0,a.Ng)(n)})},n))})}function _(e){let{title:n,titleIcon:s,titleId:i,description:a,children:_,className:m,errors:I,disabled:E=!1,hideDivider:p=!1,showBorder:N=!1,borderType:T,hasBackground:S=!1,forcedDivider:x=!1,showPremiumIcon:h=!1}=e;return(0,l.jsx)("div",{className:t()(u.customizationSection,m,{[u.disabled]:E,[u.hideDivider]:p,[u.showBorder]:N,[u.withDivider]:x}),children:(0,l.jsxs)(o.Z,{className:u.customizationSectionBorder,backgroundClassName:u.customizationSectionBackground,isShown:N,type:T,hasBackground:S,children:[(0,l.jsxs)(r.FormTitle,{className:u.title,id:i,children:[n,h&&(0,l.jsx)(c.Z,{}),s]}),null!=a?(0,l.jsx)(r.FormText,{type:r.FormText.Types.DESCRIPTION,className:u.sectionDescription,children:a}):null,_,null!=I&&(0,l.jsx)(d,{errors:I})]})})}},321051:function(e,n,s){s.d(n,{Z:function(){return m}}),s(47120);var l=s(735250),i=s(470079),t=s(692547),r=s(481060),a=s(697426),c=s(603074),o=s(689938),u=s(770771);let d=[54,8,8,8];function _(e){let{onSelect:n,sound:s}=e,[_,m]=i.useState(!1);function I(e){m(!1),null==n||n(e)}let E=e=>(0,l.jsxs)("div",{className:u.customGiftHeader,children:[(0,l.jsxs)("div",{className:u.__invalid_customGiftHeaderText,children:[(0,l.jsx)(r.Text,{variant:"text-md/bold",children:o.Z.Messages.GIFT_SELECT_SOUND}),(0,l.jsx)(r.Text,{variant:"text-sm/normal",children:o.Z.Messages.GIFT_SELECT_SOUNDBOARD_OR_EMOJI_DESCRIPTION})]}),(0,l.jsx)("div",{className:u.searchAndSound,children:e})]});return(0,l.jsx)(r.Popout,{shouldShow:_,position:"bottom",align:"left",onRequestClose:()=>m(!1),renderPopout:e=>{let{closePopout:n}=e;return(0,l.jsx)(r.Dialog,{children:(0,l.jsx)(c.Z,{suppressPlaySound:!0,shouldShowUpsell:!1,guildId:null,channel:null,onClose:n,onSelect:I,analyticsSource:"gift soundboard",soundButtonOverlay:a.Pb.ADD,listPadding:d,renderHeader:E,defaultSoundsOnly:!0})})},children:()=>(0,l.jsx)(r.Clickable,{className:u.sound,onClick:()=>m(!0),children:null==s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.SoundboardIcon,{size:"custom",color:t.Z.colors.WHITE,className:u.soundIcon,width:14,height:14}),(0,l.jsx)(r.Text,{className:u.text,variant:"text-sm/semibold",children:o.Z.Messages.GIFT_SELECT_SOUND})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Text,{className:u.textSelected,variant:"text-sm/semibold",children:s.emojiName}),(0,l.jsx)(r.Text,{className:u.text,variant:"text-sm/semibold",children:s.name})]})})})}function m(e){let{sound:n,onSelect:s}=e;return(0,l.jsx)("div",{className:u.container,children:(0,l.jsx)(_,{onSelect:s,sound:n})})}},991862:function(e,n,s){s.d(n,{T:function(){return i}});var l=s(689938);function i(e){switch(e){case"brl":return l.Z.Messages.BRL_NAME;case"pln":return l.Z.Messages.PLN_NAME;case"try":return l.Z.Messages.TRY_NAME;case"usd":return l.Z.Messages.USD_NAME;case"aud":return l.Z.Messages.AUD_NAME;case"pen":return l.Z.Messages.PEN_NAME;case"php":return l.Z.Messages.PHP_NAME;case"ars":return l.Z.Messages.ARS_NAME;case"cop":return l.Z.Messages.COP_NAME;case"clr":return l.Z.Messages.CLR_NAME;case"jpy":return l.Z.Messages.JPY_NAME;case"idr":return l.Z.Messages.IDR_NAME;case"vnd":return l.Z.Messages.VND_NAME;case"thb":return l.Z.Messages.THB_NAME;case"myr":return l.Z.Messages.MYR_NAME;case"krw":return l.Z.Messages.KRW_NAME;case"mxn":return l.Z.Messages.MXN_NAME;case"bgn":return l.Z.Messages.BGN_NAME;case"czk":return l.Z.Messages.CZK_NAME;case"dkk":return l.Z.Messages.DKK_NAME;case"huf":return l.Z.Messages.HUF_NAME;case"ron":return l.Z.Messages.RON_NAME;case"sek":return l.Z.Messages.SEK_NAME;case"eur":return l.Z.Messages.EUR_NAME;default:return""}}}}]);
//# sourceMappingURL=95900.3b90e8e776d42fe1bf5c.js.map